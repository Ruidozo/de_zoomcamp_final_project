[0m15:11:19.842767 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 24.905647, "process_user_time": 25.050104, "process_kernel_time": 1.228966, "process_mem_max_rss": "1009008", "process_in_blocks": "568", "process_out_blocks": "68536"}
[0m15:11:19.844731 [debug] [MainThread]: Command `cli show` succeeded at 15:11:19.844410 after 24.92 seconds
[0m15:11:19.845706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d30e1a260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d30e19db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d30e1a140>]}
[0m15:11:19.846575 [debug] [MainThread]: Flushing usage events
[0m15:18:19.616203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d37d60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33b9da80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33beb8e0>]}


============================== 15:18:19.623092 | 554c5e97-1419-4e52-81d5-207e5250e852 ==============================
[0m15:18:19.623092 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:18:19.624811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/de-zoomcamp-project/.profiles_interpolated_temp_8fae9750-bcee-408b-a62c-1f0cc9eb3e38', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/de-zoomcamp-project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt start de-zoomcamp-project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:20.597462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '554c5e97-1419-4e52-81d5-207e5250e852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33b9d0c0>]}
[0m15:18:20.749924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '554c5e97-1419-4e52-81d5-207e5250e852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32e9eaa0>]}
[0m15:18:20.751329 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m15:18:20.798026 [debug] [MainThread]: checksum: 0bb12ddd095ce8586f252454ca81c3348ac21e8eb74e99735e0ba66a09d30458, vars: {'block_uuid': 'dbt/models/staging/stg_staging__real_estate_data',
 'configuration': {'dbt_project_name': 'dbt',
                   'file_path': 'dbt/models/staging/stg_staging__real_estate_data.sql',
                   'file_source': {'path': 'dbt/models/staging/stg_staging__real_estate_data.sql',
                                   'project_path': 'dbt'}},
 'context': {},
 'ds': '2025-01-25',
 'env': 'prod',
 'event': {},
 'execution_date': '2025-01-25T15:17:08.810125',
 'execution_partition': '7/20250125T151708_810125',
 'hr': '15',
 'interval_end_datetime': '2025-02-01T15:17:08.810125',
 'interval_seconds': 604800,
 'interval_start_datetime': '2025-01-25T15:17:08.810125',
 'interval_start_datetime_previous': '2025-01-18T15:17:08.810125',
 'pipeline_run_id': 41,
 'pipeline_uuid': 'real_estate',
 'repo_path': '/home/src/de-zoomcamp-project',
 'retry': {'attempts': 1},
 'trigger_name': 'weekly_load_real_estate_data'}, profile: , target: , version: 1.7.4
[0m15:18:20.825899 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:18:20.827235 [debug] [MainThread]: previous checksum: 0bb12ddd095ce8586f252454ca81c3348ac21e8eb74e99735e0ba66a09d30458, current checksum: 8da15b06fbba63aac74f6d85dae4640fb1260180ae6bf8d884d6c64bc81e9ed3
[0m15:18:20.828082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '554c5e97-1419-4e52-81d5-207e5250e852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32e573a0>]}
[0m15:18:23.437091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '554c5e97-1419-4e52-81d5-207e5250e852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d329232e0>]}
[0m15:18:23.456391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '554c5e97-1419-4e52-81d5-207e5250e852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32923640>]}
[0m15:18:23.457301 [info ] [MainThread]: Found 7 models, 1 seed, 6 sources, 0 exposures, 0 metrics, 539 macros, 0 groups, 0 semantic models
[0m15:18:23.460783 [info ] [MainThread]: 
[0m15:18:23.463001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:23.465628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db'
[0m15:18:23.487973 [debug] [ThreadPool]: Using postgres connection "list_mage_db"
[0m15:18:23.488701 [debug] [ThreadPool]: On list_mage_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db"} */

    select distinct nspname from pg_namespace
  
[0m15:18:23.489272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:23.505750 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m15:18:23.508359 [debug] [ThreadPool]: On list_mage_db: Close
[0m15:18:23.512093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mage_db, now list_mage_db_public)
[0m15:18:23.521829 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:23.522494 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m15:18:23.523039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:23.538711 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:23.539483 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:23.540125 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:18:23.544187 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m15:18:23.546678 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m15:18:23.547758 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m15:18:23.553396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mage_db_public, now list_mage_db_public_public)
[0m15:18:23.561371 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:23.561932 [debug] [ThreadPool]: On list_mage_db_public_public: BEGIN
[0m15:18:23.562447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:23.577839 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:23.578576 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:23.579217 [debug] [ThreadPool]: On list_mage_db_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m15:18:23.583264 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m15:18:23.585222 [debug] [ThreadPool]: On list_mage_db_public_public: ROLLBACK
[0m15:18:23.585958 [debug] [ThreadPool]: On list_mage_db_public_public: Close
[0m15:18:23.595423 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:23.596076 [debug] [MainThread]: On master: BEGIN
[0m15:18:23.596652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:23.611896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:23.612634 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:23.613359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:23.619696 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m15:18:23.625320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '554c5e97-1419-4e52-81d5-207e5250e852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32bf10f0>]}
[0m15:18:23.626355 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:23.627288 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:23.628046 [debug] [MainThread]: On master: BEGIN
[0m15:18:23.629135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:23.629851 [debug] [MainThread]: On master: COMMIT
[0m15:18:23.630607 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:23.631313 [debug] [MainThread]: On master: COMMIT
[0m15:18:23.632219 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:23.632953 [debug] [MainThread]: On master: Close
[0m15:18:23.634565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:23.636629 [info ] [MainThread]: 
[0m15:18:23.639920 [debug] [Thread-2 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m15:18:23.640791 [info ] [Thread-2 (]: 1 of 1 START sql view model public.stg_staging__real_estate_data ............... [RUN]
[0m15:18:23.642403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_mage_db_public_public, now model.dbt_zoomcamp.stg_staging__real_estate_data)
[0m15:18:23.643059 [debug] [Thread-2 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m15:18:23.648336 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.649476 [debug] [Thread-2 (]: Timing info for model.dbt_zoomcamp.stg_staging__real_estate_data (compile): 15:18:23.643491 => 15:18:23.648999
[0m15:18:23.650125 [debug] [Thread-2 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m15:18:23.716257 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.717835 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.718798 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: BEGIN
[0m15:18:23.719679 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:18:23.735847 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:23.736744 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.737501 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */

  create view "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp"
    
    
  as (
    with 

source as (
    select * 
    from "mage_db"."public"."real_estate_data"
),

renamed as (
    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date
    from source
)

select * 
from renamed
  );
[0m15:18:23.797779 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:18:23.808987 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.809805 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data" rename to "stg_staging__real_estate_data__dbt_backup"
[0m15:18:23.817848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:23.823808 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.824544 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp" rename to "stg_staging__real_estate_data"
[0m15:18:23.825921 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:23.851206 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m15:18:23.852099 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.852775 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m15:18:23.854796 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:18:23.866968 [debug] [Thread-2 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data__dbt_backup"
[0m15:18:23.873726 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m15:18:23.874455 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data__dbt_backup" cascade
[0m15:18:23.878387 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:18:23.880847 [debug] [Thread-2 (]: Timing info for model.dbt_zoomcamp.stg_staging__real_estate_data (execute): 15:18:23.650491 => 15:18:23.880516
[0m15:18:23.881505 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: Close
[0m15:18:23.882972 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554c5e97-1419-4e52-81d5-207e5250e852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3287fe20>]}
[0m15:18:23.884290 [info ] [Thread-2 (]: 1 of 1 OK created sql view model public.stg_staging__real_estate_data .......... [[32mCREATE VIEW[0m in 0.24s]
[0m15:18:23.886082 [debug] [Thread-2 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m15:18:23.888464 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:23.889019 [debug] [MainThread]: On master: BEGIN
[0m15:18:23.889543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:23.905909 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:23.906661 [debug] [MainThread]: On master: COMMIT
[0m15:18:23.907246 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:23.907992 [debug] [MainThread]: On master: COMMIT
[0m15:18:23.908744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:23.909333 [debug] [MainThread]: On master: Close
[0m15:18:23.910871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:23.911733 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.stg_staging__real_estate_data' was properly closed.
[0m15:18:23.912632 [info ] [MainThread]: 
[0m15:18:23.913878 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:18:23.915765 [debug] [MainThread]: Command end result
[0m15:18:23.933696 [info ] [MainThread]: 
[0m15:18:23.935261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:23.936543 [info ] [MainThread]: 
[0m15:18:23.937875 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:23.939472 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.4453244, "process_user_time": 3.471665, "process_kernel_time": 0.271815, "process_mem_max_rss": "298124", "process_in_blocks": "16712", "process_out_blocks": "3592"}
[0m15:18:23.940663 [debug] [MainThread]: Command `cli build` succeeded at 15:18:23.940339 after 4.45 seconds
[0m15:18:23.941528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d37d60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32fcf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32e9eaa0>]}
[0m15:18:23.942380 [debug] [MainThread]: Flushing usage events
[0m15:18:29.717658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d37d60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33a0c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33a0df30>]}


============================== 15:18:29.723090 | 64aef571-511b-402f-9931-e64e89b316bd ==============================
[0m15:18:29.723090 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:18:29.724542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/de-zoomcamp-project/.profiles_interpolated_temp_d4562f65-331d-4c9f-83dd-ea7b63820701', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/de-zoomcamp-project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt start de-zoomcamp-project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:30.081800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64aef571-511b-402f-9931-e64e89b316bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d339474f0>]}
[0m15:18:30.238635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64aef571-511b-402f-9931-e64e89b316bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33bed570>]}
[0m15:18:30.240161 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m15:18:30.269705 [debug] [MainThread]: checksum: 032669302dc07c82a6f9148bb95b89faeedbe3c044334a9cb6fb74b1b1a72c0d, vars: {'block_uuid': 'dbt/models/staging/stg_cleaned_real_estate_data',
 'configuration': {'dbt_project_name': 'dbt',
                   'file_path': 'dbt/models/staging/stg_cleaned_real_estate_data.sql',
                   'file_source': {'path': 'dbt/models/staging/stg_cleaned_real_estate_data.sql',
                                   'project_path': 'dbt'}},
 'context': {},
 'ds': '2025-01-25',
 'env': 'prod',
 'event': {},
 'execution_date': '2025-01-25T15:17:08.810125',
 'execution_partition': '7/20250125T151708_810125',
 'hr': '15',
 'interval_end_datetime': '2025-02-01T15:17:08.810125',
 'interval_seconds': 604800,
 'interval_start_datetime': '2025-01-25T15:17:08.810125',
 'interval_start_datetime_previous': '2025-01-18T15:17:08.810125',
 'pipeline_run_id': 41,
 'pipeline_uuid': 'real_estate',
 'repo_path': '/home/src/de-zoomcamp-project',
 'retry': {'attempts': 1},
 'trigger_name': 'weekly_load_real_estate_data'}, profile: , target: , version: 1.7.4
[0m15:18:30.292686 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:18:30.293901 [debug] [MainThread]: previous checksum: 032669302dc07c82a6f9148bb95b89faeedbe3c044334a9cb6fb74b1b1a72c0d, current checksum: 0bb12ddd095ce8586f252454ca81c3348ac21e8eb74e99735e0ba66a09d30458
[0m15:18:30.294694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64aef571-511b-402f-9931-e64e89b316bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32ea2860>]}
[0m15:18:32.876409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64aef571-511b-402f-9931-e64e89b316bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d329c2380>]}
[0m15:18:32.897167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64aef571-511b-402f-9931-e64e89b316bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d329c1e40>]}
[0m15:18:32.898168 [info ] [MainThread]: Found 7 models, 1 seed, 6 sources, 0 exposures, 0 metrics, 539 macros, 0 groups, 0 semantic models
[0m15:18:32.900874 [info ] [MainThread]: 
[0m15:18:32.902649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:32.904454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db'
[0m15:18:32.920527 [debug] [ThreadPool]: Using postgres connection "list_mage_db"
[0m15:18:32.921244 [debug] [ThreadPool]: On list_mage_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db"} */

    select distinct nspname from pg_namespace
  
[0m15:18:32.921802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:32.938880 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m15:18:32.941526 [debug] [ThreadPool]: On list_mage_db: Close
[0m15:18:32.946135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db_public'
[0m15:18:32.956052 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:32.956927 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m15:18:32.957680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:32.981373 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:32.982103 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:32.982742 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:18:32.986799 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m15:18:32.989024 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m15:18:32.989733 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m15:18:32.992118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mage_db_public, now list_mage_db_public_public)
[0m15:18:33.000022 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:33.000594 [debug] [ThreadPool]: On list_mage_db_public_public: BEGIN
[0m15:18:33.001130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:33.016754 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:33.017435 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:33.018034 [debug] [ThreadPool]: On list_mage_db_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m15:18:33.022239 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m15:18:33.024271 [debug] [ThreadPool]: On list_mage_db_public_public: ROLLBACK
[0m15:18:33.025006 [debug] [ThreadPool]: On list_mage_db_public_public: Close
[0m15:18:33.034149 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.034751 [debug] [MainThread]: On master: BEGIN
[0m15:18:33.035310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:33.055610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:33.056357 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.057094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:33.062239 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m15:18:33.065456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64aef571-511b-402f-9931-e64e89b316bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32c30400>]}
[0m15:18:33.066217 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:33.066931 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.067516 [debug] [MainThread]: On master: BEGIN
[0m15:18:33.068396 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:33.068930 [debug] [MainThread]: On master: COMMIT
[0m15:18:33.069468 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.069982 [debug] [MainThread]: On master: COMMIT
[0m15:18:33.070637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:33.071175 [debug] [MainThread]: On master: Close
[0m15:18:33.072635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:33.073849 [info ] [MainThread]: 
[0m15:18:33.076945 [debug] [Thread-2 (]: Began running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m15:18:33.077784 [info ] [Thread-2 (]: 1 of 1 START sql view model public.stg_cleaned_real_estate_data ................ [RUN]
[0m15:18:33.079372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_mage_db_public_public, now model.dbt_zoomcamp.stg_cleaned_real_estate_data)
[0m15:18:33.080097 [debug] [Thread-2 (]: Began compiling node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m15:18:33.085376 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m15:18:33.086484 [debug] [Thread-2 (]: Timing info for model.dbt_zoomcamp.stg_cleaned_real_estate_data (compile): 15:18:33.080487 => 15:18:33.086034
[0m15:18:33.087132 [debug] [Thread-2 (]: Began executing node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m15:18:33.144564 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m15:18:33.146307 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m15:18:33.147026 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: BEGIN
[0m15:18:33.147675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:18:33.164844 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:33.166060 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m15:18:33.166858 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */

  create view "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp"
    
    
  as (
    WITH base AS (
    SELECT *,
           CASE 
               -- If _type is 'farm' or 'land', prioritize total_area
               WHEN LOWER(_type) IN ('farm', 'land') THEN total_area
               -- If total_area is large and gross_area is valid, use gross_area
               WHEN total_area > 1000 AND gross_area > 0 THEN gross_area
               -- Fallback to total_area
               ELSE total_area
           END AS effective_area,
           -- Calculate price_per_sqm for filtering
           price / NULLIF(
               CASE 
                   WHEN LOWER(_type) IN ('farm', 'land') THEN total_area
                   WHEN total_area > 1000 AND gross_area > 0 THEN gross_area
                   ELSE total_area
               END, 0
           ) AS price_per_sqm
    FROM "mage_db"."public"."stg_staging__real_estate_data"
)
SELECT *
FROM base
WHERE effective_area > 10
  AND (
      -- Relax price_per_sqm for general cases
      price_per_sqm BETWEEN 50 AND 100000
      OR LOWER(_type) IN ('farm', 'land') -- Skip price_per_sqm filter for farms/land
  )
  );
[0m15:18:33.211196 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:18:33.222197 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m15:18:33.223002 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
alter table "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp" rename to "stg_cleaned_real_estate_data"
[0m15:18:33.224469 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:33.246339 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m15:18:33.247242 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m15:18:33.248048 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m15:18:33.250448 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:18:33.260562 [debug] [Thread-2 (]: Applying DROP to: "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup"
[0m15:18:33.267471 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m15:18:33.268468 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
drop view if exists "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup" cascade
[0m15:18:33.269888 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:18:33.273228 [debug] [Thread-2 (]: Timing info for model.dbt_zoomcamp.stg_cleaned_real_estate_data (execute): 15:18:33.087536 => 15:18:33.272755
[0m15:18:33.274090 [debug] [Thread-2 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: Close
[0m15:18:33.278413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64aef571-511b-402f-9931-e64e89b316bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3285c4c0>]}
[0m15:18:33.279518 [info ] [Thread-2 (]: 1 of 1 OK created sql view model public.stg_cleaned_real_estate_data ........... [[32mCREATE VIEW[0m in 0.20s]
[0m15:18:33.280997 [debug] [Thread-2 (]: Finished running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m15:18:33.283085 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.283741 [debug] [MainThread]: On master: BEGIN
[0m15:18:33.284277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:33.299435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:33.300106 [debug] [MainThread]: On master: COMMIT
[0m15:18:33.300661 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:33.301179 [debug] [MainThread]: On master: COMMIT
[0m15:18:33.301833 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:33.302374 [debug] [MainThread]: On master: Close
[0m15:18:33.303851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:33.304655 [debug] [MainThread]: Connection 'list_mage_db' was properly closed.
[0m15:18:33.305412 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.stg_cleaned_real_estate_data' was properly closed.
[0m15:18:33.306188 [info ] [MainThread]: 
[0m15:18:33.307189 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:18:33.308901 [debug] [MainThread]: Command end result
[0m15:18:33.325965 [info ] [MainThread]: 
[0m15:18:33.327189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:33.328229 [info ] [MainThread]: 
[0m15:18:33.329297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:33.330617 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.702109, "process_user_time": 3.462143, "process_kernel_time": 0.230867, "process_mem_max_rss": "297984", "process_out_blocks": "3584", "process_in_blocks": "0"}
[0m15:18:33.331550 [debug] [MainThread]: Command `cli build` succeeded at 15:18:33.331316 after 3.70 seconds
[0m15:18:33.332158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d37d60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32824d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36bdd1e0>]}
[0m15:18:33.332759 [debug] [MainThread]: Flushing usage events
[0m15:18:39.841447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d37d60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33979390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33979420>]}


============================== 15:18:39.846798 | 81e7d55d-46d5-4fe3-9df4-bbd867e860f6 ==============================
[0m15:18:39.846798 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:18:39.848331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/de-zoomcamp-project/.profiles_interpolated_temp_dfe5a4a5-7890-47db-9123-ecadf3c6d616', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/de-zoomcamp-project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt start de-zoomcamp-project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:40.206894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81e7d55d-46d5-4fe3-9df4-bbd867e860f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33979480>]}
[0m15:18:40.364257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81e7d55d-46d5-4fe3-9df4-bbd867e860f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d378a3f40>]}
[0m15:18:40.365595 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m15:18:40.395216 [debug] [MainThread]: checksum: e8f8622af8c90b549925483a772f30e9309ebead96e17e84534dc0154bb26182, vars: {'block_uuid': 'dbt/models/core/real_estate_data_w_geolocation',
 'configuration': {'dbt_project_name': 'dbt',
                   'file_path': 'dbt/models/core/real_estate_data_w_geolocation.sql',
                   'file_source': {'path': 'dbt/models/core/real_estate_data_w_geolocation.sql',
                                   'project_path': 'dbt'}},
 'context': {},
 'ds': '2025-01-25',
 'env': 'prod',
 'event': {},
 'execution_date': '2025-01-25T15:17:08.810125',
 'execution_partition': '7/20250125T151708_810125',
 'hr': '15',
 'interval_end_datetime': '2025-02-01T15:17:08.810125',
 'interval_seconds': 604800,
 'interval_start_datetime': '2025-01-25T15:17:08.810125',
 'interval_start_datetime_previous': '2025-01-18T15:17:08.810125',
 'pipeline_run_id': 41,
 'pipeline_uuid': 'real_estate',
 'repo_path': '/home/src/de-zoomcamp-project',
 'retry': {'attempts': 1},
 'trigger_name': 'weekly_load_real_estate_data'}, profile: , target: , version: 1.7.4
[0m15:18:40.416909 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:18:40.418160 [debug] [MainThread]: previous checksum: e8f8622af8c90b549925483a772f30e9309ebead96e17e84534dc0154bb26182, current checksum: 032669302dc07c82a6f9148bb95b89faeedbe3c044334a9cb6fb74b1b1a72c0d
[0m15:18:40.418876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81e7d55d-46d5-4fe3-9df4-bbd867e860f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32cd9cf0>]}
[0m15:18:42.959077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81e7d55d-46d5-4fe3-9df4-bbd867e860f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32b51690>]}
[0m15:18:42.978727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81e7d55d-46d5-4fe3-9df4-bbd867e860f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32cd8ee0>]}
[0m15:18:42.979731 [info ] [MainThread]: Found 7 models, 1 seed, 6 sources, 0 exposures, 0 metrics, 539 macros, 0 groups, 0 semantic models
[0m15:18:42.982885 [info ] [MainThread]: 
[0m15:18:42.984798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:42.986653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db'
[0m15:18:43.002474 [debug] [ThreadPool]: Using postgres connection "list_mage_db"
[0m15:18:43.003150 [debug] [ThreadPool]: On list_mage_db: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db"} */

    select distinct nspname from pg_namespace
  
[0m15:18:43.003770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:43.022368 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m15:18:43.025047 [debug] [ThreadPool]: On list_mage_db: Close
[0m15:18:43.029161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db_public'
[0m15:18:43.038763 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:43.039374 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m15:18:43.039941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:43.056419 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:43.057114 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:43.057752 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:18:43.061796 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m15:18:43.064090 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m15:18:43.064784 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m15:18:43.067039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mage_db_public, now list_mage_db_public_public)
[0m15:18:43.071326 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:43.075251 [debug] [ThreadPool]: On list_mage_db_public_public: BEGIN
[0m15:18:43.076134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:43.100463 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:43.101456 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:43.102293 [debug] [ThreadPool]: On list_mage_db_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m15:18:43.106359 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m15:18:43.108421 [debug] [ThreadPool]: On list_mage_db_public_public: ROLLBACK
[0m15:18:43.109150 [debug] [ThreadPool]: On list_mage_db_public_public: Close
[0m15:18:43.118434 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:43.119068 [debug] [MainThread]: On master: BEGIN
[0m15:18:43.119671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:43.135858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:43.136617 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:43.137374 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:43.142598 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m15:18:43.146118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e7d55d-46d5-4fe3-9df4-bbd867e860f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32c9f340>]}
[0m15:18:43.147104 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:43.147982 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:43.148538 [debug] [MainThread]: On master: BEGIN
[0m15:18:43.149412 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:43.149946 [debug] [MainThread]: On master: COMMIT
[0m15:18:43.150479 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:43.150988 [debug] [MainThread]: On master: COMMIT
[0m15:18:43.151699 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:43.152272 [debug] [MainThread]: On master: Close
[0m15:18:43.153848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:43.155893 [info ] [MainThread]: 
[0m15:18:43.158865 [debug] [Thread-2 (]: Began running node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:18:43.159881 [info ] [Thread-2 (]: 1 of 1 START sql table model public.real_estate_data_w_geolocation ............. [RUN]
[0m15:18:43.161689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_mage_db_public_public, now model.dbt_zoomcamp.real_estate_data_w_geolocation)
[0m15:18:43.162350 [debug] [Thread-2 (]: Began compiling node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:18:43.169872 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:43.171303 [debug] [Thread-2 (]: Timing info for model.dbt_zoomcamp.real_estate_data_w_geolocation (compile): 15:18:43.162748 => 15:18:43.170751
[0m15:18:43.172312 [debug] [Thread-2 (]: Began executing node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:18:43.231707 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:43.232976 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:43.233731 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: BEGIN
[0m15:18:43.234368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:18:43.252730 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:43.253562 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:43.254300 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.real_estate_data_w_geolocation"} */

  
    

  create  table "mage_db"."public"."real_estate_data_w_geolocation__dbt_tmp"
  
  
    as
  
  (
    

with 

cleaned_real_estate as (
    select * 
    from "mage_db"."public"."stg_cleaned_real_estate_data"
),

geolocation_data as (
    select 
        municipio,
        "Latitude",
        "Longitude"
    from "mage_db"."public_public"."pt"
),

joined_with_geolocation as (
    select
        cleaned_real_estate.*,
        geolocation_data."Latitude" as latitude,
        geolocation_data."Longitude" as longitude
    from cleaned_real_estate
    left join geolocation_data
    on LOWER(cleaned_real_estate.city) = LOWER(geolocation_data.municipio)
)

select * 
from joined_with_geolocation
  );
  
[0m15:18:44.421418 [debug] [Thread-2 (]: SQL status: SELECT 114410 in 1.0 seconds
[0m15:18:44.432249 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:44.433091 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.real_estate_data_w_geolocation"} */
alter table "mage_db"."public"."real_estate_data_w_geolocation" rename to "real_estate_data_w_geolocation__dbt_backup"
[0m15:18:44.434320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:44.439563 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:44.440263 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.real_estate_data_w_geolocation"} */
alter table "mage_db"."public"."real_estate_data_w_geolocation__dbt_tmp" rename to "real_estate_data_w_geolocation"
[0m15:18:44.442321 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:44.473314 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: COMMIT
[0m15:18:44.474155 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:44.474876 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: COMMIT
[0m15:18:44.519177 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:18:44.536285 [debug] [Thread-2 (]: Applying DROP to: "mage_db"."public"."real_estate_data_w_geolocation__dbt_backup"
[0m15:18:44.543636 [debug] [Thread-2 (]: Using postgres connection "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:44.544471 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.real_estate_data_w_geolocation"} */
drop table if exists "mage_db"."public"."real_estate_data_w_geolocation__dbt_backup" cascade
[0m15:18:44.549753 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:18:44.552277 [debug] [Thread-2 (]: Timing info for model.dbt_zoomcamp.real_estate_data_w_geolocation (execute): 15:18:43.172831 => 15:18:44.551945
[0m15:18:44.552963 [debug] [Thread-2 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: Close
[0m15:18:44.554518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e7d55d-46d5-4fe3-9df4-bbd867e860f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33a1a5c0>]}
[0m15:18:44.555900 [info ] [Thread-2 (]: 1 of 1 OK created sql table model public.real_estate_data_w_geolocation ........ [[32mSELECT 114410[0m in 1.39s]
[0m15:18:44.557984 [debug] [Thread-2 (]: Finished running node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:18:44.560348 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:44.560917 [debug] [MainThread]: On master: BEGIN
[0m15:18:44.561524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:44.578039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:44.578844 [debug] [MainThread]: On master: COMMIT
[0m15:18:44.579540 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:44.580273 [debug] [MainThread]: On master: COMMIT
[0m15:18:44.581082 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:44.581704 [debug] [MainThread]: On master: Close
[0m15:18:44.583293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:44.584183 [debug] [MainThread]: Connection 'list_mage_db' was properly closed.
[0m15:18:44.585004 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.real_estate_data_w_geolocation' was properly closed.
[0m15:18:44.585869 [info ] [MainThread]: 
[0m15:18:44.586968 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m15:18:44.588760 [debug] [MainThread]: Command end result
[0m15:18:44.609889 [info ] [MainThread]: 
[0m15:18:44.611406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:44.613392 [info ] [MainThread]: 
[0m15:18:44.614665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:44.617805 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.8612823, "process_user_time": 3.516708, "process_kernel_time": 0.167873, "process_mem_max_rss": "298480", "process_out_blocks": "3592", "process_in_blocks": "0"}
[0m15:18:44.618970 [debug] [MainThread]: Command `cli build` succeeded at 15:18:44.618614 after 4.86 seconds
[0m15:18:44.619828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d37d60520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d327e65f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d329e6500>]}
[0m15:18:44.620569 [debug] [MainThread]: Flushing usage events
[0m15:18:45.008782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d38a54970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3292d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32c9eda0>]}


============================== 15:18:45.009596 | 37a94707-d278-4ad6-a6dd-b73b331e1d0e ==============================
[0m15:18:45.009596 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:18:45.010986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/de-zoomcamp-project/.profiles_interpolated_temp_dfe5a4a5-7890-47db-9123-ecadf3c6d616', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/de-zoomcamp-project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt start de-zoomcamp-project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:45.092025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37a94707-d278-4ad6-a6dd-b73b331e1d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d33937910>]}
[0m15:18:45.095339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37a94707-d278-4ad6-a6dd-b73b331e1d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d32a60190>]}
[0m15:18:45.096265 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m15:18:45.116116 [debug] [MainThread]: checksum: e8f8622af8c90b549925483a772f30e9309ebead96e17e84534dc0154bb26182, vars: {'block_uuid': 'dbt/models/core/real_estate_data_w_geolocation',
 'configuration': {'dbt_project_name': 'dbt',
                   'file_path': 'dbt/models/core/real_estate_data_w_geolocation.sql',
                   'file_source': {'path': 'dbt/models/core/real_estate_data_w_geolocation.sql',
                                   'project_path': 'dbt'}},
 'context': {},
 'ds': '2025-01-25',
 'env': 'prod',
 'event': {},
 'execution_date': '2025-01-25T15:17:08.810125',
 'execution_partition': '7/20250125T151708_810125',
 'hr': '15',
 'interval_end_datetime': '2025-02-01T15:17:08.810125',
 'interval_seconds': 604800,
 'interval_start_datetime': '2025-01-25T15:17:08.810125',
 'interval_start_datetime_previous': '2025-01-18T15:17:08.810125',
 'pipeline_run_id': 41,
 'pipeline_uuid': 'real_estate',
 'repo_path': '/home/src/de-zoomcamp-project',
 'retry': {'attempts': 1},
 'trigger_name': 'weekly_load_real_estate_data'}, profile: , target: , version: 1.7.4
[0m15:18:45.173155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:45.173875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:45.184399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37a94707-d278-4ad6-a6dd-b73b331e1d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d30e09f90>]}
[0m15:18:45.203071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37a94707-d278-4ad6-a6dd-b73b331e1d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d30de1900>]}
[0m15:18:45.203993 [info ] [MainThread]: Found 7 models, 1 seed, 6 sources, 0 exposures, 0 metrics, 539 macros, 0 groups, 0 semantic models
[0m15:18:45.205035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a94707-d278-4ad6-a6dd-b73b331e1d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d30de18a0>]}
[0m15:18:45.206506 [info ] [MainThread]: 
[0m15:18:45.208145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:45.210423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db_public'
[0m15:18:45.216568 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:45.217535 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m15:18:45.218223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:45.239931 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:45.240684 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m15:18:45.241318 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:18:45.245337 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m15:18:45.247701 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m15:18:45.248372 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m15:18:45.250419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mage_db_public, now list_mage_db_public_public)
[0m15:18:45.254728 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:45.258376 [debug] [ThreadPool]: On list_mage_db_public_public: BEGIN
[0m15:18:45.258876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:45.274233 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:45.274948 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public_public"
[0m15:18:45.275641 [debug] [ThreadPool]: On list_mage_db_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m15:18:45.279576 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m15:18:45.281490 [debug] [ThreadPool]: On list_mage_db_public_public: ROLLBACK
[0m15:18:45.282178 [debug] [ThreadPool]: On list_mage_db_public_public: Close
[0m15:18:45.289548 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:45.290187 [debug] [MainThread]: On master: BEGIN
[0m15:18:45.290799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:45.310907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:45.311700 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:45.312438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:45.317514 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m15:18:45.320974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37a94707-d278-4ad6-a6dd-b73b331e1d0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d30e07fd0>]}
[0m15:18:45.321638 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:45.322301 [debug] [MainThread]: On master: Close
[0m15:18:45.323715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:45.325363 [info ] [MainThread]: 
[0m15:18:45.328478 [debug] [Thread-6 (]: Began running node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:18:45.329574 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly list_mage_db_public_public, now model.dbt_zoomcamp.real_estate_data_w_geolocation)
[0m15:18:45.330232 [debug] [Thread-6 (]: Began compiling node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:18:45.336172 [debug] [Thread-6 (]: Writing injected SQL for node "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:45.337353 [debug] [Thread-6 (]: Timing info for model.dbt_zoomcamp.real_estate_data_w_geolocation (compile): 15:18:45.330604 => 15:18:45.336907
[0m15:18:45.337995 [debug] [Thread-6 (]: Began executing node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:18:45.346237 [debug] [Thread-6 (]: Using postgres connection "model.dbt_zoomcamp.real_estate_data_w_geolocation"
[0m15:18:45.346951 [debug] [Thread-6 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.real_estate_data_w_geolocation"} */


with 

cleaned_real_estate as (
    select * 
    from "mage_db"."public"."stg_cleaned_real_estate_data"
),

geolocation_data as (
    select 
        municipio,
        "Latitude",
        "Longitude"
    from "mage_db"."public_public"."pt"
),

joined_with_geolocation as (
    select
        cleaned_real_estate.*,
        geolocation_data."Latitude" as latitude,
        geolocation_data."Longitude" as longitude
    from cleaned_real_estate
    left join geolocation_data
    on LOWER(cleaned_real_estate.city) = LOWER(geolocation_data.municipio)
)

select * 
from joined_with_geolocation
[0m15:18:45.347618 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m15:18:46.282082 [debug] [Thread-6 (]: SQL status: SELECT 114410 in 1.0 seconds
[0m15:19:01.927536 [debug] [Thread-6 (]: Timing info for model.dbt_zoomcamp.real_estate_data_w_geolocation (execute): 15:18:45.338494 => 15:19:01.926910
[0m15:19:01.928443 [debug] [Thread-6 (]: On model.dbt_zoomcamp.real_estate_data_w_geolocation: Close
[0m15:19:01.930786 [debug] [Thread-6 (]: Finished running node model.dbt_zoomcamp.real_estate_data_w_geolocation
[0m15:19:01.932748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:01.933548 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.real_estate_data_w_geolocation' was properly closed.
[0m15:19:01.934992 [debug] [MainThread]: Command end result
