[0m07:09:32.152182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2b064ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2b064c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2b56edd0>]}


============================== 07:09:32.157333 | a55d21d9-5911-49f4-b996-274468933e65 ==============================
[0m07:09:32.157333 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:09:32.158232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:09:32.161409 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_zoomcamp'
[0m07:09:32.163968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.092097424, "process_in_blocks": "104", "process_kernel_time": 0.219926, "process_mem_max_rss": "89376", "process_out_blocks": "8", "process_user_time": 1.567555}
[0m07:09:32.164825 [debug] [MainThread]: Command `dbt run` failed at 07:09:32.164572 after 0.09 seconds
[0m07:09:32.165553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2b454350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2b059f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2b059e50>]}
[0m07:09:32.166126 [debug] [MainThread]: Flushing usage events
[0m07:09:32.549742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:12:00.449509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe833f32490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe833fec750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe833f33510>]}


============================== 07:12:00.510312 | 04cd6fd4-d2c7-4494-96ed-de185c21e673 ==============================
[0m07:12:00.510312 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:12:00.511373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:12:00.517800 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m07:12:00.518800 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_zoomcamp", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m07:12:00.520931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.13980278, "process_in_blocks": "12384", "process_kernel_time": 0.286753, "process_mem_max_rss": "89016", "process_out_blocks": "16", "process_user_time": 1.565059}
[0m07:12:00.521850 [debug] [MainThread]: Command `dbt run` failed at 07:12:00.521680 after 0.14 seconds
[0m07:12:00.522396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8378894d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe837889390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8343ea950>]}
[0m07:12:00.522974 [debug] [MainThread]: Flushing usage events
[0m07:12:00.886257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:12:32.509867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8052ad5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805292b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805292b850>]}


============================== 07:12:32.516724 | d0cc57e7-7925-456d-aa5a-619af312c3ec ==============================
[0m07:12:32.516724 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:12:32.517624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'profiles_dir': '/home/ruicarvalho/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:12:32.777556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80523c1150>]}
[0m07:12:32.849143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805292ae90>]}
[0m07:12:32.850336 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:12:32.993909 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:12:32.994869 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:12:32.995470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8051f2b950>]}
[0m07:12:34.368432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8051f2a110>]}
[0m07:12:34.461514 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m07:12:34.465955 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m07:12:34.657087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80517547d0>]}
[0m07:12:34.657926 [info ] [MainThread]: Found 8 models, 4 sources, 431 macros
[0m07:12:34.658513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80513ee310>]}
[0m07:12:34.661363 [info ] [MainThread]: 
[0m07:12:34.661951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:12:34.662484 [info ] [MainThread]: 
[0m07:12:34.663595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:12:34.671061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db'
[0m07:12:34.897591 [debug] [ThreadPool]: Using postgres connection "list_mage_db"
[0m07:12:34.898335 [debug] [ThreadPool]: On list_mage_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db"} */

    select distinct nspname from pg_namespace
  
[0m07:12:34.898960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:12:35.877086 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.978 seconds
[0m07:12:35.880054 [debug] [ThreadPool]: On list_mage_db: Close
[0m07:12:35.884692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mage_db, now list_mage_db_public)
[0m07:12:35.892088 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m07:12:35.892578 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m07:12:35.893091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:12:35.908508 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m07:12:35.909359 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m07:12:35.910055 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:12:36.000475 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.090 seconds
[0m07:12:36.002642 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m07:12:36.003489 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m07:12:36.028332 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:36.030022 [debug] [MainThread]: On master: BEGIN
[0m07:12:36.030880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:12:36.050482 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m07:12:36.051499 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:36.052446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:12:36.076310 [debug] [MainThread]: SQL status: SELECT 6 in 0.023 seconds
[0m07:12:36.079760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8051752550>]}
[0m07:12:36.080477 [debug] [MainThread]: On master: ROLLBACK
[0m07:12:36.081364 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:36.081942 [debug] [MainThread]: On master: BEGIN
[0m07:12:36.083434 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:12:36.084124 [debug] [MainThread]: On master: COMMIT
[0m07:12:36.084815 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:36.085460 [debug] [MainThread]: On master: COMMIT
[0m07:12:36.086374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:12:36.087228 [debug] [MainThread]: On master: Close
[0m07:12:36.092070 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m07:12:36.093067 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_staging__real_estate_data ............... [RUN]
[0m07:12:36.094102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mage_db_public, now model.dbt_zoomcamp.stg_staging__real_estate_data)
[0m07:12:36.094777 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m07:12:36.112008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.114641 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m07:12:36.183337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.186024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.186878 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: BEGIN
[0m07:12:36.187612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:36.208902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m07:12:36.209931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.210813 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */

  create view "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m07:12:36.358198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.146 seconds
[0m07:12:36.367568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.368246 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data" rename to "stg_staging__real_estate_data__dbt_backup"
[0m07:12:36.369729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:36.373755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.374291 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp" rename to "stg_staging__real_estate_data"
[0m07:12:36.375636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:36.395603 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m07:12:36.396373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.396997 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m07:12:36.530149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.133 seconds
[0m07:12:36.538870 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data__dbt_backup"
[0m07:12:36.545926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m07:12:36.546563 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data__dbt_backup" cascade
[0m07:12:36.601974 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.055 seconds
[0m07:12:36.610701 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: Close
[0m07:12:36.666719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80513a06d0>]}
[0m07:12:36.668252 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_staging__real_estate_data .......... [[32mCREATE VIEW[0m in 0.52s]
[0m07:12:36.677206 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m07:12:36.678647 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m07:12:36.680049 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_staging__real_estate_data_weekly ........ [RUN]
[0m07:12:36.681400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data, now model.dbt_zoomcamp.stg_staging__real_estate_data_weekly)
[0m07:12:36.682502 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m07:12:36.689605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.691294 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m07:12:36.699900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.701613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.702535 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: BEGIN
[0m07:12:36.703366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:36.724052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m07:12:36.725272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.726271 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */

  create view "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data_weekly"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m07:12:36.733394 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:12:36.740525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.741515 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly" rename to "stg_staging__real_estate_data_weekly__dbt_backup"
[0m07:12:36.743598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:36.749806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.750648 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp" rename to "stg_staging__real_estate_data_weekly"
[0m07:12:36.752553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:36.759009 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m07:12:36.759969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.760831 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m07:12:36.763864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:12:36.769983 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup"
[0m07:12:36.771549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m07:12:36.772390 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup" cascade
[0m07:12:36.777809 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m07:12:36.780726 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: Close
[0m07:12:36.782227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804f6bd510>]}
[0m07:12:36.783486 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_staging__real_estate_data_weekly ... [[32mCREATE VIEW[0m in 0.10s]
[0m07:12:36.785051 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m07:12:36.786095 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stats
[0m07:12:36.787192 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_staging__stats .......................... [RUN]
[0m07:12:36.788674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data_weekly, now model.dbt_zoomcamp.stg_staging__stats)
[0m07:12:36.789861 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stats
[0m07:12:36.796042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.797637 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stats
[0m07:12:36.806269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.815069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.816936 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: BEGIN
[0m07:12:36.819184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:36.857597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m07:12:36.858614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.859404 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */

  create view "mage_db"."public"."stg_staging__stats__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."stats"

),

renamed as (

    select
        _column_name,
        data_type,
        missing_percent,
        missing_quant,
        dups,
        uniques,
        _count,
        _min,
        _max,
        average,
        standard_deviation

    from source

)

select * from renamed
  );
[0m07:12:36.864782 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:12:36.872106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.872969 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats" rename to "stg_staging__stats__dbt_backup"
[0m07:12:36.874869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:36.881269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.882115 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats__dbt_tmp" rename to "stg_staging__stats"
[0m07:12:36.884601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:12:36.888104 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m07:12:36.888960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.889731 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m07:12:36.892402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:12:36.897656 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stats__dbt_backup"
[0m07:12:36.899338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m07:12:36.900160 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
drop view if exists "mage_db"."public"."stg_staging__stats__dbt_backup" cascade
[0m07:12:36.903940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m07:12:36.906725 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: Close
[0m07:12:36.908221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804f6bced0>]}
[0m07:12:36.909486 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_staging__stats ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m07:12:36.910941 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stats
[0m07:12:36.912916 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m07:12:36.914358 [info ] [Thread-1 (]: 4 of 8 START sql view model public.stg_cleaned_real_estate_data ................ [RUN]
[0m07:12:36.916147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__stats, now model.dbt_zoomcamp.stg_cleaned_real_estate_data)
[0m07:12:36.917479 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m07:12:36.924367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m07:12:36.925822 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m07:12:36.933470 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m07:12:36.935066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m07:12:36.935884 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: BEGIN
[0m07:12:36.936686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:36.959616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m07:12:36.960725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m07:12:36.961620 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */

  create view "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp"
    
    
  as (
    WITH base AS (
    SELECT *
    FROM "mage_db"."public"."stg_staging__real_estate_data"
)
SELECT *
FROM base
WHERE total_area > 10
  AND price > 100
  AND price / NULLIF(total_area, 0) BETWEEN 100 AND 50000
  );
[0m07:12:36.970502 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m07:12:36.977337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m07:12:36.978190 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
alter table "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp" rename to "stg_cleaned_real_estate_data"
[0m07:12:36.980040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:36.983161 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m07:12:36.983925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m07:12:36.984607 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m07:12:36.987575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:12:36.992658 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup"
[0m07:12:36.994079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m07:12:36.994793 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
drop view if exists "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup" cascade
[0m07:12:36.996067 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:12:37.009250 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: Close
[0m07:12:37.014101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805237a750>]}
[0m07:12:37.015544 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.stg_cleaned_real_estate_data ........... [[32mCREATE VIEW[0m in 0.10s]
[0m07:12:37.017264 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m07:12:37.019125 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m07:12:37.020217 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_avg_price_per_sqm_by_city_overall ....... [RUN]
[0m07:12:37.022158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_cleaned_real_estate_data, now model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall)
[0m07:12:37.023592 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m07:12:37.030945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.032802 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m07:12:37.043757 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.045542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.046400 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: BEGIN
[0m07:12:37.047183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:37.067239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m07:12:37.068318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.069525 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"} */

  create view "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_tmp"
    
    
  as (
    with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
  )
select
  city,
  district,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city, district
order by avg_price_per_sqm desc
  );
[0m07:12:37.074979 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:12:37.081594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.082466 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"} */
alter table "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_tmp" rename to "stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.084214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:37.091016 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: COMMIT
[0m07:12:37.091834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.092536 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: COMMIT
[0m07:12:37.094843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:12:37.099600 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_backup"
[0m07:12:37.101184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m07:12:37.101904 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"} */
drop view if exists "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_backup" cascade
[0m07:12:37.103188 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:12:37.105757 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: Close
[0m07:12:37.110768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804dd04210>]}
[0m07:12:37.111974 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_avg_price_per_sqm_by_city_overall .. [[32mCREATE VIEW[0m in 0.09s]
[0m07:12:37.113102 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m07:12:37.113896 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m07:12:37.115023 [info ] [Thread-1 (]: 6 of 8 START sql table model public.stg_avg_price_per_sqm_by_city_residential .. [RUN]
[0m07:12:37.116278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall, now model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential)
[0m07:12:37.117151 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m07:12:37.124603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.126205 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m07:12:37.182667 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.184809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.185775 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: BEGIN
[0m07:12:37.186667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:37.204954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m07:12:37.206140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.207191 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */

  
    

  create  table "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_tmp"
  
  
    as
  
  (
    

WITH 
  base AS (
      SELECT
          city,
          district,
          total_area,
          price,
          price / NULLIF(total_area, 0) AS price_per_sqm
      FROM "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        AND total_area > 0  -- Ensure total_area is valid
        AND price > 0       -- Ensure price is valid
  )
SELECT
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  COUNT(*) AS property_count,
  ROUND(AVG(price_per_sqm)::numeric, 2) AS avg_price_per_sqm
FROM base
WHERE price_per_sqm <= 10000  -- Exclude rows where price_per_sqm is greater than 10,000
GROUP BY city
ORDER BY avg_price_per_sqm DESC
  );
  
[0m07:12:37.493618 [debug] [Thread-1 (]: SQL status: SELECT 269 in 0.285 seconds
[0m07:12:37.500785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.502148 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */
alter table "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential" rename to "stg_avg_price_per_sqm_by_city_residential__dbt_backup"
[0m07:12:37.504179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:37.513002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.514349 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */
alter table "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_tmp" rename to "stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.516047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:37.528170 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: COMMIT
[0m07:12:37.529260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.530108 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: COMMIT
[0m07:12:37.534526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:12:37.539834 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_backup"
[0m07:12:37.547100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m07:12:37.548027 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */
drop table if exists "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_backup" cascade
[0m07:12:37.553302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:12:37.556077 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: Close
[0m07:12:37.561937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80513bb850>]}
[0m07:12:37.563671 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.stg_avg_price_per_sqm_by_city_residential  [[32mSELECT 269[0m in 0.45s]
[0m07:12:37.564959 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m07:12:37.565861 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_price_trends
[0m07:12:37.566979 [info ] [Thread-1 (]: 7 of 8 START sql table model public.stg_price_trends ........................... [RUN]
[0m07:12:37.568000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential, now model.dbt_zoomcamp.stg_price_trends)
[0m07:12:37.568859 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_price_trends
[0m07:12:37.576283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.577880 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_price_trends
[0m07:12:37.585534 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.587036 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.587828 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: BEGIN
[0m07:12:37.588580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:37.606685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m07:12:37.607691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.608564 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */

  
    

  create  table "mage_db"."public"."stg_price_trends__dbt_tmp"
  
  
    as
  
  (
    

WITH date_trends AS (
    SELECT
        COALESCE(
            EXTRACT(YEAR FROM publish_date::DATE),
            EXTRACT(YEAR FROM push_date::DATE)
        ) AS year,
        CAST(
            COALESCE(
                EXTRACT(MONTH FROM publish_date::DATE),
                EXTRACT(MONTH FROM push_date::DATE)
            ) AS INT
        ) AS month, -- Ensure month is an integer
        ROUND(AVG(price)::numeric) AS avg_price, -- Remove decimal points
        COUNT(*) AS total_entries -- Count total listings
    FROM "mage_db"."public"."stg_cleaned_real_estate_data"
    WHERE price > 0
    GROUP BY year, month
)
SELECT
    year,
    month,
    TO_CHAR(avg_price, 'FM999,999,999') AS avg_price, -- No decimals, apply thousands separator
    TO_CHAR(total_entries, 'FM999,999,999') AS total_entries -- Apply thousands separator
FROM date_trends
ORDER BY year, month
  );
  
[0m07:12:37.947483 [debug] [Thread-1 (]: SQL status: SELECT 67 in 0.338 seconds
[0m07:12:37.956953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.957979 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */
alter table "mage_db"."public"."stg_price_trends" rename to "stg_price_trends__dbt_backup"
[0m07:12:37.959821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:37.966305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.967203 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */
alter table "mage_db"."public"."stg_price_trends__dbt_tmp" rename to "stg_price_trends"
[0m07:12:37.968918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:37.972479 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: COMMIT
[0m07:12:37.973395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.974204 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: COMMIT
[0m07:12:37.976858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:12:37.982229 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_price_trends__dbt_backup"
[0m07:12:37.983791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m07:12:37.984607 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */
drop table if exists "mage_db"."public"."stg_price_trends__dbt_backup" cascade
[0m07:12:37.988857 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:12:37.991422 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: Close
[0m07:12:37.993122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8051340b90>]}
[0m07:12:37.994434 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.stg_price_trends ...................... [[32mSELECT 67[0m in 0.42s]
[0m07:12:37.995947 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_price_trends
[0m07:12:37.997090 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m07:12:37.998249 [info ] [Thread-1 (]: 8 of 8 START sql view model public.stg_staging__stg_avg_price_per_city_residential  [RUN]
[0m07:12:37.999608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_price_trends, now model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential)
[0m07:12:38.001057 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m07:12:38.008090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.009880 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m07:12:38.017583 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.019388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.020239 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: BEGIN
[0m07:12:38.021042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:12:38.040939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m07:12:38.042223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.043293 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */

  create view "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp"
    
    
  as (
    with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        and total_area > 0  -- Ensure total_area is valid
        and price > 0       -- Ensure price is valid
  )
select
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city
ORDER BY avg_price_per_sqm DESC
  );
[0m07:12:38.049739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:12:38.056462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.057451 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
alter table "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp" rename to "stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.059358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:12:38.062356 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m07:12:38.063166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.063904 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m07:12:38.066381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:12:38.071303 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup"
[0m07:12:38.073167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m07:12:38.074008 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
drop view if exists "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup" cascade
[0m07:12:38.075595 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:12:38.078239 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: Close
[0m07:12:38.084016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0cc57e7-7925-456d-aa5a-619af312c3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804f623950>]}
[0m07:12:38.085483 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.stg_staging__stg_avg_price_per_city_residential  [[32mCREATE VIEW[0m in 0.08s]
[0m07:12:38.087176 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m07:12:38.089587 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:38.090218 [debug] [MainThread]: On master: BEGIN
[0m07:12:38.090789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:12:38.111136 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m07:12:38.112058 [debug] [MainThread]: On master: COMMIT
[0m07:12:38.112858 [debug] [MainThread]: Using postgres connection "master"
[0m07:12:38.113540 [debug] [MainThread]: On master: COMMIT
[0m07:12:38.114581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:12:38.115273 [debug] [MainThread]: On master: Close
[0m07:12:38.120106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:12:38.120799 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential' was properly closed.
[0m07:12:38.128805 [info ] [MainThread]: 
[0m07:12:38.130113 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m07:12:38.133529 [debug] [MainThread]: Command end result
[0m07:12:38.280040 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m07:12:38.289097 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m07:12:38.321127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m07:12:38.321978 [info ] [MainThread]: 
[0m07:12:38.325456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:12:38.328279 [info ] [MainThread]: 
[0m07:12:38.333622 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m07:12:38.363349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9223585, "process_in_blocks": "47800", "process_kernel_time": 0.495609, "process_mem_max_rss": "113944", "process_out_blocks": "2936", "process_user_time": 4.260807}
[0m07:12:38.364357 [debug] [MainThread]: Command `dbt run` succeeded at 07:12:38.364137 after 5.92 seconds
[0m07:12:38.365369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805292c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805292d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80513a49d0>]}
[0m07:12:38.366246 [debug] [MainThread]: Flushing usage events
[0m07:12:38.797559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:05.076138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd5eb3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd5edbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd5eb3c50>]}


============================== 09:31:05.095900 | 720102f3-5d62-4eb5-ac03-06533be9dfae ==============================
[0m09:31:05.095900 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:31:05.096969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:31:05.305074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd5f06350>]}
[0m09:31:05.385672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd806ac10>]}
[0m09:31:05.386973 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:31:05.547624 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:31:05.676358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:05.677015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:05.723583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd4f28c10>]}
[0m09:31:05.819217 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m09:31:05.823649 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m09:31:05.845379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd4b14110>]}
[0m09:31:05.846291 [info ] [MainThread]: Found 8 models, 4 sources, 431 macros
[0m09:31:05.846883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd530a950>]}
[0m09:31:05.849607 [info ] [MainThread]: 
[0m09:31:05.850308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:31:05.850880 [info ] [MainThread]: 
[0m09:31:05.852844 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:31:05.861844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db'
[0m09:31:06.013216 [debug] [ThreadPool]: Using postgres connection "list_mage_db"
[0m09:31:06.014117 [debug] [ThreadPool]: On list_mage_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db"} */

    select distinct nspname from pg_namespace
  
[0m09:31:06.014799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:06.790352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.775 seconds
[0m09:31:06.792377 [debug] [ThreadPool]: On list_mage_db: Close
[0m09:31:06.795981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db_public'
[0m09:31:06.804901 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m09:31:06.805508 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m09:31:06.806011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:06.853478 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m09:31:06.854162 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m09:31:06.854723 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:31:06.899942 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.045 seconds
[0m09:31:06.902269 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m09:31:06.903303 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m09:31:06.913800 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:06.914435 [debug] [MainThread]: On master: BEGIN
[0m09:31:06.914953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:06.927152 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:31:06.927740 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:06.928428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:31:06.976047 [debug] [MainThread]: SQL status: SELECT 6 in 0.047 seconds
[0m09:31:06.979344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd4bc6cd0>]}
[0m09:31:06.980046 [debug] [MainThread]: On master: ROLLBACK
[0m09:31:06.981055 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:06.981617 [debug] [MainThread]: On master: BEGIN
[0m09:31:06.982988 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:31:06.983489 [debug] [MainThread]: On master: COMMIT
[0m09:31:06.983976 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:06.984426 [debug] [MainThread]: On master: COMMIT
[0m09:31:06.985268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:31:06.985730 [debug] [MainThread]: On master: Close
[0m09:31:06.988877 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m09:31:06.990114 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_staging__real_estate_data ............... [RUN]
[0m09:31:06.990982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mage_db_public, now model.dbt_zoomcamp.stg_staging__real_estate_data)
[0m09:31:06.991524 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m09:31:07.002266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.003264 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m09:31:07.050526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.051858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.052449 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: BEGIN
[0m09:31:07.052980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:07.065530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:31:07.066264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.066903 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */

  create view "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m09:31:07.174528 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.107 seconds
[0m09:31:07.183363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.184040 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data" rename to "stg_staging__real_estate_data__dbt_backup"
[0m09:31:07.185589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.189710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.190295 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp" rename to "stg_staging__real_estate_data"
[0m09:31:07.191597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.212435 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m09:31:07.213159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.214083 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m09:31:07.216519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:07.225019 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data__dbt_backup"
[0m09:31:07.232337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m09:31:07.233043 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data__dbt_backup" cascade
[0m09:31:07.267090 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m09:31:07.270649 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: Close
[0m09:31:07.274842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3fd6350>]}
[0m09:31:07.275907 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_staging__real_estate_data .......... [[32mCREATE VIEW[0m in 0.28s]
[0m09:31:07.276960 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m09:31:07.277576 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m09:31:07.278656 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_staging__real_estate_data_weekly ........ [RUN]
[0m09:31:07.279505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data, now model.dbt_zoomcamp.stg_staging__real_estate_data_weekly)
[0m09:31:07.280064 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m09:31:07.285331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.286259 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m09:31:07.291272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.292248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.292855 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: BEGIN
[0m09:31:07.293373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:07.305618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:31:07.306454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.307132 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */

  create view "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data_weekly"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m09:31:07.311741 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:31:07.316451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.317044 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly" rename to "stg_staging__real_estate_data_weekly__dbt_backup"
[0m09:31:07.318396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.322554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.323108 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp" rename to "stg_staging__real_estate_data_weekly"
[0m09:31:07.324408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.326492 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m09:31:07.327031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.327553 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m09:31:07.330217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:07.333739 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup"
[0m09:31:07.334830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m09:31:07.335393 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup" cascade
[0m09:31:07.338915 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:31:07.340745 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: Close
[0m09:31:07.341977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3fd8150>]}
[0m09:31:07.343385 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_staging__real_estate_data_weekly ... [[32mCREATE VIEW[0m in 0.06s]
[0m09:31:07.344580 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m09:31:07.345764 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stats
[0m09:31:07.346593 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_staging__stats .......................... [RUN]
[0m09:31:07.347327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data_weekly, now model.dbt_zoomcamp.stg_staging__stats)
[0m09:31:07.347876 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stats
[0m09:31:07.352236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.353231 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stats
[0m09:31:07.360588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.361609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.362223 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: BEGIN
[0m09:31:07.362728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:07.374021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:31:07.374766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.375366 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */

  create view "mage_db"."public"."stg_staging__stats__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."stats"

),

renamed as (

    select
        _column_name,
        data_type,
        missing_percent,
        missing_quant,
        dups,
        uniques,
        _count,
        _min,
        _max,
        average,
        standard_deviation

    from source

)

select * from renamed
  );
[0m09:31:07.378444 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:31:07.383355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.383928 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats" rename to "stg_staging__stats__dbt_backup"
[0m09:31:07.385255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.389347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.389887 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats__dbt_tmp" rename to "stg_staging__stats"
[0m09:31:07.391145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.393361 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m09:31:07.393896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.394444 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m09:31:07.396883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:07.400378 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stats__dbt_backup"
[0m09:31:07.401388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m09:31:07.401913 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
drop view if exists "mage_db"."public"."stg_staging__stats__dbt_backup" cascade
[0m09:31:07.404958 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:31:07.406903 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: Close
[0m09:31:07.408136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1728490>]}
[0m09:31:07.409571 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_staging__stats ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m09:31:07.410863 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stats
[0m09:31:07.412170 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m09:31:07.413002 [info ] [Thread-1 (]: 4 of 8 START sql view model public.stg_cleaned_real_estate_data ................ [RUN]
[0m09:31:07.413802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__stats, now model.dbt_zoomcamp.stg_cleaned_real_estate_data)
[0m09:31:07.414396 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m09:31:07.418548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m09:31:07.419627 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m09:31:07.424711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m09:31:07.426282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m09:31:07.426869 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: BEGIN
[0m09:31:07.427574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:07.439049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:31:07.439747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m09:31:07.440330 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */

  create view "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp"
    
    
  as (
    WITH base AS (
    SELECT *
    FROM "mage_db"."public"."stg_staging__real_estate_data"
)
SELECT *
FROM base
WHERE total_area > 10
  AND price > 100
  AND price / NULLIF(total_area, 0) BETWEEN 100 AND 50000
  );
[0m09:31:07.448442 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:31:07.453445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m09:31:07.454119 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
alter table "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp" rename to "stg_cleaned_real_estate_data"
[0m09:31:07.455460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.457353 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m09:31:07.457903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m09:31:07.458452 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m09:31:07.460728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:07.463980 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup"
[0m09:31:07.465144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m09:31:07.465814 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
drop view if exists "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup" cascade
[0m09:31:07.467057 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:31:07.468897 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: Close
[0m09:31:07.470037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd171a710>]}
[0m09:31:07.471393 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.stg_cleaned_real_estate_data ........... [[32mCREATE VIEW[0m in 0.06s]
[0m09:31:07.472819 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m09:31:07.474343 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m09:31:07.475296 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_avg_price_per_sqm_by_city_overall ....... [RUN]
[0m09:31:07.476034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_cleaned_real_estate_data, now model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall)
[0m09:31:07.476571 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m09:31:07.481361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.482232 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m09:31:07.487129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.488090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.488646 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: BEGIN
[0m09:31:07.489156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:07.500865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:31:07.503565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.504339 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"} */

  create view "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_tmp"
    
    
  as (
    with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
  )
select
  city,
  district,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city, district
order by avg_price_per_sqm desc
  );
[0m09:31:07.513032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:31:07.517963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.518707 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"} */
alter table "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_tmp" rename to "stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.520120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:07.522144 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: COMMIT
[0m09:31:07.522728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.523298 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: COMMIT
[0m09:31:07.525570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:07.530491 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_backup"
[0m09:31:07.531547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"
[0m09:31:07.532078 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall"} */
drop view if exists "mage_db"."public"."stg_avg_price_per_sqm_by_city_overall__dbt_backup" cascade
[0m09:31:07.533050 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:31:07.534815 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall: Close
[0m09:31:07.535950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd17147d0>]}
[0m09:31:07.537219 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_avg_price_per_sqm_by_city_overall .. [[32mCREATE VIEW[0m in 0.06s]
[0m09:31:07.538896 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall
[0m09:31:07.539470 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m09:31:07.540251 [info ] [Thread-1 (]: 6 of 8 START sql table model public.stg_avg_price_per_sqm_by_city_residential .. [RUN]
[0m09:31:07.540973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_overall, now model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential)
[0m09:31:07.541492 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m09:31:07.546372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:07.547291 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m09:31:07.575133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:07.576298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:07.576955 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: BEGIN
[0m09:31:07.577475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:07.589423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:31:07.590238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:07.590995 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */

  
    

  create  table "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_tmp"
  
  
    as
  
  (
    

WITH 
  base AS (
      SELECT
          city,
          district,
          total_area,
          price,
          price / NULLIF(total_area, 0) AS price_per_sqm
      FROM "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        AND total_area > 0  -- Ensure total_area is valid
        AND price > 0       -- Ensure price is valid
  )
SELECT
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  COUNT(*) AS property_count,
  ROUND(AVG(price_per_sqm)::numeric, 2) AS avg_price_per_sqm
FROM base
WHERE price_per_sqm <= 10000  -- Exclude rows where price_per_sqm is greater than 10,000
GROUP BY city
ORDER BY avg_price_per_sqm DESC
  );
  
[0m09:31:08.179645 [debug] [Thread-1 (]: SQL status: SELECT 269 in 0.588 seconds
[0m09:31:08.184414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:08.185147 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */
alter table "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential" rename to "stg_avg_price_per_sqm_by_city_residential__dbt_backup"
[0m09:31:08.186471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:08.190654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:08.191236 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */
alter table "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_tmp" rename to "stg_avg_price_per_sqm_by_city_residential"
[0m09:31:08.192362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:08.198658 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: COMMIT
[0m09:31:08.199300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:08.199824 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: COMMIT
[0m09:31:08.202408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:08.205719 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_backup"
[0m09:31:08.210044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"
[0m09:31:08.210713 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential"} */
drop table if exists "mage_db"."public"."stg_avg_price_per_sqm_by_city_residential__dbt_backup" cascade
[0m09:31:08.214978 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m09:31:08.216999 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential: Close
[0m09:31:08.218240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3fbaa50>]}
[0m09:31:08.219668 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.stg_avg_price_per_sqm_by_city_residential  [[32mSELECT 269[0m in 0.68s]
[0m09:31:08.221366 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential
[0m09:31:08.222214 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_price_trends
[0m09:31:08.222992 [info ] [Thread-1 (]: 7 of 8 START sql table model public.stg_price_trends ........................... [RUN]
[0m09:31:08.223749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_avg_price_per_sqm_by_city_residential, now model.dbt_zoomcamp.stg_price_trends)
[0m09:31:08.224290 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_price_trends
[0m09:31:08.230014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.230995 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_price_trends
[0m09:31:08.236102 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.237008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.237559 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: BEGIN
[0m09:31:08.238045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:08.249390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:31:08.250347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.250973 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */

  
    

  create  table "mage_db"."public"."stg_price_trends__dbt_tmp"
  
  
    as
  
  (
    

WITH date_trends AS (
    SELECT
        COALESCE(
            EXTRACT(YEAR FROM publish_date::DATE),
            EXTRACT(YEAR FROM push_date::DATE)
        ) AS year,
        CAST(
            COALESCE(
                EXTRACT(MONTH FROM publish_date::DATE),
                EXTRACT(MONTH FROM push_date::DATE)
            ) AS INT
        ) AS month, -- Ensure month is an integer
        ROUND(AVG(price)::numeric) AS avg_price, -- Remove decimal points
        COUNT(*) AS total_entries -- Count total listings
    FROM "mage_db"."public"."stg_cleaned_real_estate_data"
    WHERE price > 0
    GROUP BY year, month
)
SELECT
    year,
    month,
    TO_CHAR(avg_price, 'FM999,999,999') AS avg_price, -- No decimals, apply thousands separator
    TO_CHAR(total_entries, 'FM999,999,999') AS total_entries -- Apply thousands separator
FROM date_trends
ORDER BY year, month
  );
  
[0m09:31:08.436092 [debug] [Thread-1 (]: SQL status: SELECT 67 in 0.184 seconds
[0m09:31:08.440825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.441475 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */
alter table "mage_db"."public"."stg_price_trends" rename to "stg_price_trends__dbt_backup"
[0m09:31:08.442781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:08.446971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.447587 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */
alter table "mage_db"."public"."stg_price_trends__dbt_tmp" rename to "stg_price_trends"
[0m09:31:08.448776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:08.451193 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: COMMIT
[0m09:31:08.451740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.452275 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: COMMIT
[0m09:31:08.454357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:08.459857 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_price_trends__dbt_backup"
[0m09:31:08.460958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_price_trends"
[0m09:31:08.461553 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_price_trends"} */
drop table if exists "mage_db"."public"."stg_price_trends__dbt_backup" cascade
[0m09:31:08.465077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m09:31:08.467112 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_price_trends: Close
[0m09:31:08.468516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1776d50>]}
[0m09:31:08.469934 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.stg_price_trends ...................... [[32mSELECT 67[0m in 0.24s]
[0m09:31:08.471665 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_price_trends
[0m09:31:08.472562 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m09:31:08.473369 [info ] [Thread-1 (]: 8 of 8 START sql view model public.stg_staging__stg_avg_price_per_city_residential  [RUN]
[0m09:31:08.474236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_price_trends, now model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential)
[0m09:31:08.474796 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m09:31:08.479652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.480565 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m09:31:08.485550 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.486709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.487378 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: BEGIN
[0m09:31:08.487898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:08.499359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:31:08.500105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.500727 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */

  create view "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp"
    
    
  as (
    with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        and total_area > 0  -- Ensure total_area is valid
        and price > 0       -- Ensure price is valid
  )
select
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city
ORDER BY avg_price_per_sqm DESC
  );
[0m09:31:08.505289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:31:08.509942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.510698 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
alter table "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp" rename to "stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.512043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:08.513981 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m09:31:08.514608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.515162 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m09:31:08.517385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:31:08.520839 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup"
[0m09:31:08.521872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m09:31:08.522454 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
drop view if exists "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup" cascade
[0m09:31:08.523514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:31:08.525284 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: Close
[0m09:31:08.526513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720102f3-5d62-4eb5-ac03-06533be9dfae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1774610>]}
[0m09:31:08.527850 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.stg_staging__stg_avg_price_per_city_residential  [[32mCREATE VIEW[0m in 0.05s]
[0m09:31:08.529898 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m09:31:08.531835 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:08.532276 [debug] [MainThread]: On master: BEGIN
[0m09:31:08.532698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:31:08.544250 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:31:08.544918 [debug] [MainThread]: On master: COMMIT
[0m09:31:08.545606 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:08.546190 [debug] [MainThread]: On master: COMMIT
[0m09:31:08.547155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:31:08.547631 [debug] [MainThread]: On master: Close
[0m09:31:08.548692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:08.549413 [debug] [MainThread]: Connection 'list_mage_db' was properly closed.
[0m09:31:08.550121 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential' was properly closed.
[0m09:31:08.551060 [info ] [MainThread]: 
[0m09:31:08.552317 [info ] [MainThread]: Finished running 2 table models, 6 view models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m09:31:08.554682 [debug] [MainThread]: Command end result
[0m09:31:08.589908 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m09:31:08.592186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m09:31:08.600681 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m09:31:08.601411 [info ] [MainThread]: 
[0m09:31:08.602129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:31:08.602679 [info ] [MainThread]: 
[0m09:31:08.603256 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m09:31:08.606165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6008751, "process_in_blocks": "5784", "process_kernel_time": 0.338887, "process_mem_max_rss": "110912", "process_out_blocks": "2048", "process_user_time": 2.885694}
[0m09:31:08.607814 [debug] [MainThread]: Command `dbt run` succeeded at 09:31:08.607615 after 3.60 seconds
[0m09:31:08.609021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd62a2ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd628ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd9805d50>]}
[0m09:31:08.610248 [debug] [MainThread]: Flushing usage events
[0m09:31:09.034851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:14.251480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1538b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a15486d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a15388f50>]}


============================== 17:04:14.274740 | af81583a-6904-4630-bfb9-80856af32404 ==============================
[0m17:04:14.274740 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:04:14.275890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:04:14.415633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af81583a-6904-4630-bfb9-80856af32404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a152c7450>]}
[0m17:04:14.551921 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-da4zv6x0'
[0m17:04:14.552784 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:04:14.622649 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:04:14.623755 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:04:14.667292 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:04:14.673418 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:04:14.687257 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:04:14.705155 [info ] [MainThread]: Updating lock file in file path: /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/package-lock.yml
[0m17:04:14.708211 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zvu8b18p'
[0m17:04:14.714805 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:04:14.933169 [info ] [MainThread]: Installed from version 0.13.1
[0m17:04:14.934445 [info ] [MainThread]: Up to date!
[0m17:04:14.935465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af81583a-6904-4630-bfb9-80856af32404', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1516dad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1517fe10>]}
[0m17:04:14.936212 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:04:15.206184 [info ] [MainThread]: Installed from version 1.3.0
[0m17:04:15.206980 [info ] [MainThread]: Up to date!
[0m17:04:15.207733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af81583a-6904-4630-bfb9-80856af32404', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a151b1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a151b0310>]}
[0m17:04:15.211540 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.040068, "process_in_blocks": "288", "process_kernel_time": 0.240038, "process_mem_max_rss": "92772", "process_out_blocks": "3096", "process_user_time": 1.859689}
[0m17:04:15.212879 [debug] [MainThread]: Command `dbt deps` succeeded at 17:04:15.212669 after 1.04 seconds
[0m17:04:15.215768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a18cc5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a18cc53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a18cc5bd0>]}
[0m17:04:15.216479 [debug] [MainThread]: Flushing usage events
[0m17:04:15.573609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:58.187270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb23bd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb220d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb2208ed0>]}


============================== 17:04:58.191860 | b2d759ad-11f9-437f-a0ce-2492997e2ad4 ==============================
[0m17:04:58.191860 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:04:58.192825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'profiles_dir': '/home/ruicarvalho/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:58.416801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb3830890>]}
[0m17:04:58.494141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb456fa10>]}
[0m17:04:58.495384 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:04:58.761869 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:04:58.896910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:58.897534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:58.942486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb2218510>]}
[0m17:04:59.051771 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m17:04:59.066030 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m17:04:59.086271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb0d1dd90>]}
[0m17:04:59.087083 [info ] [MainThread]: Found 9 models, 4 sources, 569 macros
[0m17:04:59.087667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb155c190>]}
[0m17:04:59.090410 [info ] [MainThread]: 
[0m17:04:59.090983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:59.091500 [info ] [MainThread]: 
[0m17:04:59.092374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:04:59.101047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db'
[0m17:04:59.161118 [debug] [ThreadPool]: Using postgres connection "list_mage_db"
[0m17:04:59.161793 [debug] [ThreadPool]: On list_mage_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db"} */

    select distinct nspname from pg_namespace
  
[0m17:04:59.162352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:59.177919 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m17:04:59.179895 [debug] [ThreadPool]: On list_mage_db: Close
[0m17:04:59.184335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db_public'
[0m17:04:59.192479 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m17:04:59.193020 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m17:04:59.193468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:59.205073 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:04:59.205618 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m17:04:59.206180 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:04:59.210976 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m17:04:59.212997 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m17:04:59.213765 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m17:04:59.224264 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:59.224798 [debug] [MainThread]: On master: BEGIN
[0m17:04:59.225249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:59.238362 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:04:59.239002 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:59.239714 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:04:59.247575 [debug] [MainThread]: SQL status: SELECT 6 in 0.007 seconds
[0m17:04:59.250926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb15fad90>]}
[0m17:04:59.251613 [debug] [MainThread]: On master: ROLLBACK
[0m17:04:59.252633 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:59.253358 [debug] [MainThread]: On master: BEGIN
[0m17:04:59.255167 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:04:59.255845 [debug] [MainThread]: On master: COMMIT
[0m17:04:59.256484 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:59.257100 [debug] [MainThread]: On master: COMMIT
[0m17:04:59.258054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:04:59.258724 [debug] [MainThread]: On master: Close
[0m17:04:59.266521 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:04:59.267567 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_staging__real_estate_data ............... [RUN]
[0m17:04:59.269234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mage_db_public, now model.dbt_zoomcamp.stg_staging__real_estate_data)
[0m17:04:59.270442 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:04:59.287864 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.289082 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:04:59.359678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.361852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.362540 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: BEGIN
[0m17:04:59.363067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:59.376288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:04:59.377240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.377923 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */

  create view "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m17:04:59.456245 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.077 seconds
[0m17:04:59.467824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.468598 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data" rename to "stg_staging__real_estate_data__dbt_backup"
[0m17:04:59.470437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:59.474956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.475590 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp" rename to "stg_staging__real_estate_data"
[0m17:04:59.477135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:59.497993 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m17:04:59.498812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.499404 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m17:04:59.502443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:04:59.512074 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data__dbt_backup"
[0m17:04:59.519161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:04:59.519838 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data__dbt_backup" cascade
[0m17:04:59.527151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:04:59.530506 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: Close
[0m17:04:59.535032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaf43fdd0>]}
[0m17:04:59.536268 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_staging__real_estate_data .......... [[32mCREATE VIEW[0m in 0.26s]
[0m17:04:59.537856 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:04:59.538528 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:04:59.539508 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_staging__real_estate_data_weekly ........ [RUN]
[0m17:04:59.540286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data, now model.dbt_zoomcamp.stg_staging__real_estate_data_weekly)
[0m17:04:59.540824 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:04:59.545647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.546534 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:04:59.552081 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.553063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.553621 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: BEGIN
[0m17:04:59.554163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:59.566894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:04:59.567605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.568232 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */

  create view "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data_weekly"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m17:04:59.572079 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:04:59.576877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.577561 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly" rename to "stg_staging__real_estate_data_weekly__dbt_backup"
[0m17:04:59.579018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:59.583450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.584104 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp" rename to "stg_staging__real_estate_data_weekly"
[0m17:04:59.585399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:59.588162 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m17:04:59.588900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.589572 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m17:04:59.592443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:04:59.598726 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup"
[0m17:04:59.600378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:04:59.601318 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup" cascade
[0m17:04:59.605812 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:04:59.608704 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: Close
[0m17:04:59.614818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb1d74110>]}
[0m17:04:59.616322 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_staging__real_estate_data_weekly ... [[32mCREATE VIEW[0m in 0.07s]
[0m17:04:59.617625 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:04:59.618782 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stats
[0m17:04:59.620182 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_staging__stats .......................... [RUN]
[0m17:04:59.621205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data_weekly, now model.dbt_zoomcamp.stg_staging__stats)
[0m17:04:59.622082 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stats
[0m17:04:59.629144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.630027 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stats
[0m17:04:59.636662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.637775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.638500 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: BEGIN
[0m17:04:59.639060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:59.650129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:04:59.650808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.651370 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */

  create view "mage_db"."public"."stg_staging__stats__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."stats"

),

renamed as (

    select
        _column_name,
        data_type,
        missing_percent,
        missing_quant,
        dups,
        uniques,
        _count,
        _min,
        _max,
        average,
        standard_deviation

    from source

)

select * from renamed
  );
[0m17:04:59.654250 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:04:59.659097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.659646 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats" rename to "stg_staging__stats__dbt_backup"
[0m17:04:59.660918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:59.664932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.665634 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats__dbt_tmp" rename to "stg_staging__stats"
[0m17:04:59.666756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:59.669082 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m17:04:59.669635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.670356 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m17:04:59.672605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:04:59.676279 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stats__dbt_backup"
[0m17:04:59.677292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m17:04:59.677820 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
drop view if exists "mage_db"."public"."stg_staging__stats__dbt_backup" cascade
[0m17:04:59.680668 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:04:59.682489 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: Close
[0m17:04:59.683646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaf4aead0>]}
[0m17:04:59.684935 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_staging__stats ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:04:59.686354 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stats
[0m17:04:59.687096 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:04:59.687942 [info ] [Thread-1 (]: 4 of 8 START sql view model public.stg_cleaned_real_estate_data ................ [RUN]
[0m17:04:59.688742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__stats, now model.dbt_zoomcamp.stg_cleaned_real_estate_data)
[0m17:04:59.689268 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:04:59.693688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:04:59.694566 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:04:59.699706 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:04:59.700624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:04:59.701261 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: BEGIN
[0m17:04:59.701764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:59.713846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m17:04:59.714536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:04:59.715116 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */

  create view "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp"
    
    
  as (
    WITH base AS (
    SELECT *
    FROM "mage_db"."public"."stg_staging__real_estate_data"
)
SELECT *
FROM base
WHERE total_area > 10
  AND price > 100
  AND price / NULLIF(total_area, 0) BETWEEN 100 AND 50000
  );
[0m17:04:59.734032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m17:04:59.739120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:04:59.739711 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
alter table "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp" rename to "stg_cleaned_real_estate_data"
[0m17:04:59.741014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:59.742899 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m17:04:59.743450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:04:59.743968 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m17:04:59.746283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:04:59.749620 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup"
[0m17:04:59.750713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:04:59.751243 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
drop view if exists "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup" cascade
[0m17:04:59.752285 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:04:59.754050 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: Close
[0m17:04:59.755179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaf586310>]}
[0m17:04:59.756329 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.stg_cleaned_real_estate_data ........... [[32mCREATE VIEW[0m in 0.07s]
[0m17:04:59.757333 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:04:59.759136 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:04:59.759810 [info ] [Thread-1 (]: 5 of 8 START sql table model public.avg_price_per_sqm_by_city_overall .......... [RUN]
[0m17:04:59.760516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_cleaned_real_estate_data, now model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall)
[0m17:04:59.761055 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:04:59.765771 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:04:59.767642 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:04:59.800203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:04:59.801342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:04:59.801933 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: BEGIN
[0m17:04:59.802511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:59.814460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m17:04:59.815151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:04:59.815758 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"} */

  
    

  create  table "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_tmp"
  
  
    as
  
  (
    

with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
  )
select
  city,
  district,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city, district
order by avg_price_per_sqm desc
  );
  
[0m17:04:59.994876 [debug] [Thread-1 (]: SQL status: SELECT 271 in 0.178 seconds
[0m17:05:00.000782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:05:00.001432 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"} */
alter table "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_tmp" rename to "avg_price_per_sqm_by_city_overall"
[0m17:05:00.002667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:00.009108 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: COMMIT
[0m17:05:00.009907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:05:00.010607 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: COMMIT
[0m17:05:00.013236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:00.016874 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_backup"
[0m17:05:00.021050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:05:00.021623 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"} */
drop table if exists "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_backup" cascade
[0m17:05:00.022673 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:05:00.024425 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: Close
[0m17:05:00.025583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdadb13110>]}
[0m17:05:00.026904 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.avg_price_per_sqm_by_city_overall ..... [[32mSELECT 271[0m in 0.27s]
[0m17:05:00.028518 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:05:00.029404 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:05:00.030231 [info ] [Thread-1 (]: 6 of 8 START sql table model public.avg_price_per_sqm_by_city_residential ...... [RUN]
[0m17:05:00.031061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall, now model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential)
[0m17:05:00.031643 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:05:00.036984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:05:00.037798 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:05:00.043204 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:05:00.044106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:05:00.044682 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: BEGIN
[0m17:05:00.045184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:00.056277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:05:00.057020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:05:00.057665 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"} */

  
    

  create  table "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_tmp"
  
  
    as
  
  (
    

WITH 
  base AS (
      SELECT
          city,
          district,
          total_area,
          price,
          price / NULLIF(total_area, 0) AS price_per_sqm
      FROM "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        AND total_area > 0  -- Ensure total_area is valid
        AND price > 0       -- Ensure price is valid
  )
SELECT
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  COUNT(*) AS property_count,
  ROUND(AVG(price_per_sqm)::numeric, 2) AS avg_price_per_sqm
FROM base
WHERE price_per_sqm <= 10000  -- Exclude rows where price_per_sqm is greater than 10,000
GROUP BY city
ORDER BY avg_price_per_sqm DESC
  );
  
[0m17:05:00.177660 [debug] [Thread-1 (]: SQL status: SELECT 269 in 0.119 seconds
[0m17:05:00.182386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:05:00.183045 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"} */
alter table "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_tmp" rename to "avg_price_per_sqm_by_city_residential"
[0m17:05:00.184369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:00.186813 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: COMMIT
[0m17:05:00.187398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:05:00.187930 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: COMMIT
[0m17:05:00.190762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:00.194246 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_backup"
[0m17:05:00.195245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:05:00.195773 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"} */
drop table if exists "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_backup" cascade
[0m17:05:00.196779 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:05:00.198613 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: Close
[0m17:05:00.199705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaf477ed0>]}
[0m17:05:00.200823 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.avg_price_per_sqm_by_city_residential . [[32mSELECT 269[0m in 0.17s]
[0m17:05:00.202303 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:05:00.203035 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.price_trends
[0m17:05:00.203957 [info ] [Thread-1 (]: 7 of 8 START sql table model public.price_trends ............................... [RUN]
[0m17:05:00.204882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential, now model.dbt_zoomcamp.price_trends)
[0m17:05:00.205400 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.price_trends
[0m17:05:00.214698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.price_trends"
[0m17:05:00.216487 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.price_trends
[0m17:05:00.233228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.price_trends"
[0m17:05:00.235084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m17:05:00.235947 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: BEGIN
[0m17:05:00.236716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:00.253069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:05:00.253767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m17:05:00.254397 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.price_trends"} */

  
    

  create  table "mage_db"."public"."price_trends__dbt_tmp"
  
  
    as
  
  (
    

WITH date_trends AS (
    SELECT
        COALESCE(
            EXTRACT(YEAR FROM publish_date::DATE),
            EXTRACT(YEAR FROM push_date::DATE)
        ) AS year,
        CAST(
            COALESCE(
                EXTRACT(MONTH FROM publish_date::DATE),
                EXTRACT(MONTH FROM push_date::DATE)
            ) AS INT
        ) AS month, -- Ensure month is an integer
        ROUND(AVG(price)::numeric) AS avg_price, -- Remove decimal points
        COUNT(*) AS total_entries -- Count total listings
    FROM "mage_db"."public"."stg_cleaned_real_estate_data"
    WHERE price > 0
    GROUP BY year, month
)
SELECT
    year,
    month,
    TO_CHAR(avg_price, 'FM999,999,999') AS avg_price, -- No decimals, apply thousands separator
    TO_CHAR(total_entries, 'FM999,999,999') AS total_entries -- Apply thousands separator
FROM date_trends
ORDER BY year, month
  );
  
[0m17:05:00.429599 [debug] [Thread-1 (]: SQL status: SELECT 67 in 0.174 seconds
[0m17:05:00.505257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m17:05:00.505952 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.price_trends"} */
alter table "mage_db"."public"."price_trends__dbt_tmp" rename to "price_trends"
[0m17:05:00.507353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:00.509504 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: COMMIT
[0m17:05:00.510057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m17:05:00.510616 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: COMMIT
[0m17:05:00.512833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:00.516423 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."price_trends__dbt_backup"
[0m17:05:00.517485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m17:05:00.518033 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.price_trends"} */
drop table if exists "mage_db"."public"."price_trends__dbt_backup" cascade
[0m17:05:00.519145 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:05:00.520934 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: Close
[0m17:05:00.522139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdaf4c52d0>]}
[0m17:05:00.523457 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.price_trends .......................... [[32mSELECT 67[0m in 0.32s]
[0m17:05:00.524618 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.price_trends
[0m17:05:00.525484 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:05:00.526547 [info ] [Thread-1 (]: 8 of 8 START sql view model public.stg_staging__stg_avg_price_per_city_residential  [RUN]
[0m17:05:00.527442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.price_trends, now model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential)
[0m17:05:00.527989 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:05:00.532344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.533377 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:05:00.539459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.540427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.541007 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: BEGIN
[0m17:05:00.541525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:00.553399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m17:05:00.554164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.554812 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */

  create view "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp"
    
    
  as (
    with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        and total_area > 0  -- Ensure total_area is valid
        and price > 0       -- Ensure price is valid
  )
select
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city
ORDER BY avg_price_per_sqm DESC
  );
[0m17:05:00.559433 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:05:00.563853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.564458 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
alter table "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp" rename to "stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.565730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:00.567642 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m17:05:00.568207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.568728 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m17:05:00.571252 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:00.575052 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup"
[0m17:05:00.576096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:05:00.576641 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
drop view if exists "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup" cascade
[0m17:05:00.577772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:05:00.579609 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: Close
[0m17:05:00.580720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d759ad-11f9-437f-a0ce-2492997e2ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb2a8c8d0>]}
[0m17:05:00.581973 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.stg_staging__stg_avg_price_per_city_residential  [[32mCREATE VIEW[0m in 0.05s]
[0m17:05:00.583039 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:05:00.585083 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:00.585572 [debug] [MainThread]: On master: BEGIN
[0m17:05:00.586009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:00.598274 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:05:00.598981 [debug] [MainThread]: On master: COMMIT
[0m17:05:00.599496 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:00.599975 [debug] [MainThread]: On master: COMMIT
[0m17:05:00.600699 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:05:00.601162 [debug] [MainThread]: On master: Close
[0m17:05:00.602023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:00.602594 [debug] [MainThread]: Connection 'list_mage_db' was properly closed.
[0m17:05:00.603095 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential' was properly closed.
[0m17:05:00.603874 [info ] [MainThread]: 
[0m17:05:00.605180 [info ] [MainThread]: Finished running 3 table models, 5 view models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m17:05:00.608067 [debug] [MainThread]: Command end result
[0m17:05:00.661331 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m17:05:00.663821 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m17:05:00.671850 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m17:05:00.672381 [info ] [MainThread]: 
[0m17:05:00.673059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:00.673605 [info ] [MainThread]: 
[0m17:05:00.674211 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:05:00.675481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.560978, "process_in_blocks": "992", "process_kernel_time": 0.393802, "process_mem_max_rss": "113084", "process_out_blocks": "2712", "process_user_time": 3.083268}
[0m17:05:00.676074 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:00.675914 after 2.56 seconds
[0m17:05:00.676589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb5cb5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb5cb5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb5cb5e50>]}
[0m17:05:00.677127 [debug] [MainThread]: Flushing usage events
[0m17:05:01.089390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:33.322531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66215c4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662199a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6621612310>]}


============================== 17:05:33.326662 | 9729cb93-7764-4714-8cda-1956c0219c48 ==============================
[0m17:05:33.326662 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:05:33.327652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:05:33.475823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9729cb93-7764-4714-8cda-1956c0219c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662145ce10>]}
[0m17:05:33.511972 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ctud2n1l'
[0m17:05:33.512851 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:33.549090 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:33.550288 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:05:33.593593 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:05:33.596667 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:33.615468 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:33.620977 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:05:33.898463 [info ] [MainThread]: Installed from version 0.13.1
[0m17:05:33.899756 [info ] [MainThread]: Up to date!
[0m17:05:33.900782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9729cb93-7764-4714-8cda-1956c0219c48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6622372d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6621ca2350>]}
[0m17:05:33.901534 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:05:34.176142 [info ] [MainThread]: Installed from version 1.3.0
[0m17:05:34.177456 [info ] [MainThread]: Up to date!
[0m17:05:34.178564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9729cb93-7764-4714-8cda-1956c0219c48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662145d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662146d5d0>]}
[0m17:05:34.180669 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.92501205, "process_in_blocks": "0", "process_kernel_time": 0.312095, "process_mem_max_rss": "92712", "process_out_blocks": "3088", "process_user_time": 1.897072}
[0m17:05:34.182082 [debug] [MainThread]: Command `dbt deps` succeeded at 17:05:34.181880 after 0.93 seconds
[0m17:05:34.183335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66219ae690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66219ae710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6624ed1cd0>]}
[0m17:05:34.184194 [debug] [MainThread]: Flushing usage events
[0m17:05:34.526954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:43.552514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c6757950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c6754f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c6755bd0>]}


============================== 17:05:43.556536 | 88422d58-6015-4bd7-8c0f-ad1749a0cc9e ==============================
[0m17:05:43.556536 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:05:43.557540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:05:43.701213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88422d58-6015-4bd7-8c0f-ad1749a0cc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c6693ad0>]}
[0m17:05:43.718668 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f1mue5p5'
[0m17:05:43.719554 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:05:43.738328 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:05:43.739469 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:05:43.753540 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:05:43.759879 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:05:43.774977 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:05:43.780413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/codegen.json
[0m17:05:43.945852 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/codegen.json 200
[0m17:05:43.947043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `fishtown-analytics/codegen` package is deprecated in favor of
`dbt-labs/codegen`. Please update your `packages.yml` configuration to use
`dbt-labs/codegen` instead.
[0m17:05:43.947677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88422d58-6015-4bd7-8c0f-ad1749a0cc9e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c6555650>]}
[0m17:05:43.949009 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package fishtown-analytics/codegen
  Requested range: =0.5.0, =0.5.0
  Compatible versions: ['0.0.1', '0.0.2', '0.0.3', '0.0.4', '0.1.0', '0.2.0', '0.3.0', '0.3.1', '0.3.2']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m17:05:43.962254 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/deps.py", line 219, in run
    self.lock()
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package fishtown-analytics/codegen
  Requested range: =0.5.0, =0.5.0
  Compatible versions: ['0.0.1', '0.0.2', '0.0.3', '0.0.4', '0.1.0', '0.2.0', '0.3.0', '0.3.1', '0.3.2']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m17:05:43.963883 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.4781443, "process_in_blocks": "56", "process_kernel_time": 0.32205, "process_mem_max_rss": "92524", "process_out_blocks": "16", "process_user_time": 2.345714}
[0m17:05:43.964553 [debug] [MainThread]: Command `dbt deps` failed at 17:05:43.964359 after 0.48 seconds
[0m17:05:43.965119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c65c7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c6b43150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71c6c34090>]}
[0m17:05:43.965699 [debug] [MainThread]: Flushing usage events
[0m17:05:44.296318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:01.181342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532d5bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053314a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532d59110>]}


============================== 17:06:01.186239 | 4e0194e7-8504-4761-a4d6-f7bfcabe5057 ==============================
[0m17:06:01.186239 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:06:01.187193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:01.332155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e0194e7-8504-4761-a4d6-f7bfcabe5057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532c70490>]}
[0m17:06:01.351298 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l9lpaaau'
[0m17:06:01.352168 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:06:01.398611 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:06:01.399848 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:06:01.464284 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:06:01.470841 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:06:01.483335 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:06:01.488903 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/codegen.json
[0m17:06:01.526789 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/codegen.json 200
[0m17:06:01.528015 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `fishtown-analytics/codegen` package is deprecated in favor of
`dbt-labs/codegen`. Please update your `packages.yml` configuration to use
`dbt-labs/codegen` instead.
[0m17:06:01.528835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e0194e7-8504-4761-a4d6-f7bfcabe5057', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532b4f810>]}
[0m17:06:01.533854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
[0m17:06:01.803987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
[0m17:06:01.816000 [error] [MainThread]: Encountered an error:
Found duplicate project "codegen". This occurs when a dependency has the same project name as some other dependency.
[0m17:06:01.818560 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/deps.py", line 219, in run
    self.lock()
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/deps/resolver.py", line 136, in resolve_packages
    _check_for_duplicate_project_names(resolved, project, renderer)
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/deps/resolver.py", line 110, in _check_for_duplicate_project_names
    raise DuplicateProjectDependencyError(project_name)
dbt.exceptions.DuplicateProjectDependencyError: Found duplicate project "codegen". This occurs when a dependency has the same project name as some other dependency.

[0m17:06:01.820137 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.7101174, "process_in_blocks": "0", "process_kernel_time": 0.350501, "process_mem_max_rss": "92436", "process_out_blocks": "16", "process_user_time": 2.508357}
[0m17:06:01.820831 [debug] [MainThread]: Command `dbt deps` failed at 17:06:01.820636 after 0.71 seconds
[0m17:06:01.821416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053314ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532e55050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0536641510>]}
[0m17:06:01.822200 [debug] [MainThread]: Flushing usage events
[0m17:06:02.179304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:15.263702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5aa50e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5b127310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5ab4d010>]}


============================== 17:06:15.268676 | 178c2bed-55b1-4f08-9a31-a52b38e28a56 ==============================
[0m17:06:15.268676 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:06:15.269666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:06:15.415284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '178c2bed-55b1-4f08-9a31-a52b38e28a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5a953a50>]}
[0m17:06:15.448229 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cpidts9a'
[0m17:06:15.449099 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:06:15.471214 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:06:15.472548 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:06:15.487754 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:06:15.490761 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:06:15.506223 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:06:15.511618 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:06:15.736825 [info ] [MainThread]: Installed from version 0.13.1
[0m17:06:15.738070 [info ] [MainThread]: Up to date!
[0m17:06:15.739169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '178c2bed-55b1-4f08-9a31-a52b38e28a56', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5a8e1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5aa901d0>]}
[0m17:06:15.739915 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:06:16.012754 [info ] [MainThread]: Installed from version 1.3.0
[0m17:06:16.013515 [info ] [MainThread]: Up to date!
[0m17:06:16.014281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '178c2bed-55b1-4f08-9a31-a52b38e28a56', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5a8ab290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5a8e1090>]}
[0m17:06:16.016246 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8241664, "process_in_blocks": "0", "process_kernel_time": 0.362745, "process_mem_max_rss": "92768", "process_out_blocks": "3088", "process_user_time": 2.345805}
[0m17:06:16.016993 [debug] [MainThread]: Command `dbt deps` succeeded at 17:06:16.016819 after 0.83 seconds
[0m17:06:16.017607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5ae3e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5e36dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5e36d410>]}
[0m17:06:16.018379 [debug] [MainThread]: Flushing usage events
[0m17:06:16.353320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:18.870756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4e5ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4e5bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4e58dd0>]}


============================== 17:08:18.875786 | 4dcde9e5-a038-4dfc-87ff-27ecb703dd9c ==============================
[0m17:08:18.875786 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:08:18.876764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'profiles_dir': '/home/ruicarvalho/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:19.027628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dcde9e5-a038-4dfc-87ff-27ecb703dd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4d97110>]}
[0m17:08:19.065264 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-136r4nqd'
[0m17:08:19.066679 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:08:19.133606 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:08:19.134968 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:08:19.180883 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:08:19.184127 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:08:19.233532 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:08:19.242308 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:08:19.486371 [info ] [MainThread]: Installed from version 0.13.1
[0m17:08:19.498242 [info ] [MainThread]: Up to date!
[0m17:08:19.499651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4dcde9e5-a038-4dfc-87ff-27ecb703dd9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4d8ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a5fad150>]}
[0m17:08:19.500466 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:08:19.765691 [info ] [MainThread]: Installed from version 1.3.0
[0m17:08:19.766577 [info ] [MainThread]: Up to date!
[0m17:08:19.767328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4dcde9e5-a038-4dfc-87ff-27ecb703dd9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4d09190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4cb31d0>]}
[0m17:08:19.769310 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9745681, "process_in_blocks": "4320", "process_kernel_time": 0.403686, "process_mem_max_rss": "92736", "process_out_blocks": "3088", "process_user_time": 1.933819}
[0m17:08:19.770065 [debug] [MainThread]: Command `dbt deps` succeeded at 17:08:19.769890 after 0.98 seconds
[0m17:08:19.770773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a4e87550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a52468d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a8775d10>]}
[0m17:08:19.771454 [debug] [MainThread]: Flushing usage events
[0m17:08:20.108443 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:25.915853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551519c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155156b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15518f2b90>]}


============================== 17:08:25.920600 | ede09723-398d-4552-b149-d394d4309288 ==============================
[0m17:08:25.920600 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:08:25.921542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:26.312926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ede09723-398d-4552-b149-d394d4309288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551a794d0>]}
[0m17:08:26.389946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ede09723-398d-4552-b149-d394d4309288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1553707750>]}
[0m17:08:26.391221 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:08:26.516546 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:08:26.664349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:08:26.665424 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/core/schema.yml
[0m17:08:26.666571 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/core/model_generator.sql
[0m17:08:26.935071 [error] [MainThread]: Encountered an error:
Compilation Error in model model_generator (models/core/model_generator.sql)
  'dict object' has no attribute 'nodes'
[0m17:08:26.936664 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.0927738, "process_in_blocks": "1552", "process_kernel_time": 0.300396, "process_mem_max_rss": "103708", "process_out_blocks": "8", "process_user_time": 2.393446}
[0m17:08:26.937362 [debug] [MainThread]: Command `dbt build` failed at 17:08:26.937166 after 1.09 seconds
[0m17:08:26.937967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551519a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155151a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1554e4dd10>]}
[0m17:08:26.938757 [debug] [MainThread]: Flushing usage events
[0m17:08:27.274317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:01.777308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab75ba6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab75baa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab7409a90>]}


============================== 17:09:01.781431 | 612a9154-f7c1-4d3c-b7bd-93f569a76d8f ==============================
[0m17:09:01.781431 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:09:01.782389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:01.987641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '612a9154-f7c1-4d3c-b7bd-93f569a76d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab6f043d0>]}
[0m17:09:02.067985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '612a9154-f7c1-4d3c-b7bd-93f569a76d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab6b2c3d0>]}
[0m17:09:02.069176 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:09:02.181880 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:09:02.321644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:09:02.322678 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/core/schema.yml
[0m17:09:02.323351 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/core/model_generator.sql
[0m17:09:02.582284 [error] [MainThread]: Encountered an error:
Compilation Error in model model_generator (models/core/model_generator.sql)
  'dict object' has no attribute 'nodes'
[0m17:09:02.583834 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.87297046, "process_in_blocks": "0", "process_kernel_time": 0.275515, "process_mem_max_rss": "103764", "process_out_blocks": "16", "process_user_time": 2.324333}
[0m17:09:02.584501 [debug] [MainThread]: Command `dbt build` failed at 17:09:02.584314 after 0.87 seconds
[0m17:09:02.585086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab741ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab73f46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab7a94210>]}
[0m17:09:02.585714 [debug] [MainThread]: Flushing usage events
[0m17:09:02.911410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:14.353786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c444bfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4489ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c444bcd10>]}


============================== 17:10:14.358207 | 715a71f9-4f85-497c-8736-46ea37cb83cd ==============================
[0m17:10:14.358207 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:10:14.359220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'profiles_dir': '/home/ruicarvalho/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:14.577002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '715a71f9-4f85-497c-8736-46ea37cb83cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c443f80d0>]}
[0m17:10:14.659671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '715a71f9-4f85-497c-8736-46ea37cb83cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c46663490>]}
[0m17:10:14.660895 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:14.782610 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:10:14.924950 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 1 files changed.
[0m17:10:14.925926 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__stg_avg_price_per_city_residential.sql
[0m17:10:14.926680 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_cleaned_real_estate_data.sql
[0m17:10:14.927219 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__real_estate_data.sql
[0m17:10:14.927740 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/model_generator.sql
[0m17:10:14.928247 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__real_estate_data_weekly.sql
[0m17:10:14.928746 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__stats.sql
[0m17:10:14.929370 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/core/schema.yml
[0m17:10:14.929840 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__stg_avg_price_per_city_residential.sql
[0m17:10:14.930398 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__real_estate_data_weekly.sql
[0m17:10:14.931485 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_cleaned_real_estate_data.sql
[0m17:10:14.932010 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__real_estate_data.sql
[0m17:10:14.932485 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__stats.sql
[0m17:10:14.932942 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/core/model_generator.sql
[0m17:10:15.237400 [error] [MainThread]: Encountered an error:
Compilation Error in model model_generator (models/staging/model_generator.sql)
  'dict object' has no attribute 'nodes'
[0m17:10:15.239109 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.9541134, "process_in_blocks": "0", "process_kernel_time": 0.262848, "process_mem_max_rss": "105984", "process_out_blocks": "16", "process_user_time": 2.528708}
[0m17:10:15.239846 [debug] [MainThread]: Command `dbt build` failed at 17:10:15.239643 after 0.96 seconds
[0m17:10:15.240448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c444fc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c4295cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c42dff190>]}
[0m17:10:15.241108 [debug] [MainThread]: Flushing usage events
[0m17:10:15.596124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:23.093641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c8e1c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c8e72150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c8e71c50>]}


============================== 17:10:23.097800 | 80c73cdd-de2e-4930-bdea-8bdb12a0943f ==============================
[0m17:10:23.097800 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:10:23.098829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:23.306818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80c73cdd-de2e-4930-bdea-8bdb12a0943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c8ca6290>]}
[0m17:10:23.383334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80c73cdd-de2e-4930-bdea-8bdb12a0943f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3cb018490>]}
[0m17:10:23.384556 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:23.498921 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:10:23.644901 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 1 files changed.
[0m17:10:23.645799 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__real_estate_data.sql
[0m17:10:23.646457 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/model_generator.sql
[0m17:10:23.646986 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_cleaned_real_estate_data.sql
[0m17:10:23.647487 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__real_estate_data_weekly.sql
[0m17:10:23.647991 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__stg_avg_price_per_city_residential.sql
[0m17:10:23.648484 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__stats.sql
[0m17:10:23.649172 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/core/schema.yml
[0m17:10:23.649627 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__stats.sql
[0m17:10:23.650364 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_cleaned_real_estate_data.sql
[0m17:10:23.650808 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/core/model_generator.sql
[0m17:10:23.651254 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__real_estate_data_weekly.sql
[0m17:10:23.651711 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__stg_avg_price_per_city_residential.sql
[0m17:10:23.652157 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__real_estate_data.sql
[0m17:10:23.926419 [error] [MainThread]: Encountered an error:
Compilation Error in model model_generator (models/staging/model_generator.sql)
  'dict object' has no attribute 'nodes'
[0m17:10:23.927911 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.90291876, "process_in_blocks": "0", "process_kernel_time": 0.270839, "process_mem_max_rss": "105964", "process_out_blocks": "8", "process_user_time": 2.369183}
[0m17:10:23.928599 [debug] [MainThread]: Command `dbt compile` failed at 17:10:23.928401 after 0.90 seconds
[0m17:10:23.929191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c8e71a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c8e58150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c731f850>]}
[0m17:10:23.929811 [debug] [MainThread]: Flushing usage events
[0m17:10:24.260240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:33.358756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe50cd990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe50cd7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe50ce110>]}


============================== 17:10:33.362778 | 2c436780-9f17-468d-9084-8b927d9245c7 ==============================
[0m17:10:33.362778 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:10:33.363746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:33.574900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c436780-9f17-468d-9084-8b927d9245c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe49cb8d0>]}
[0m17:10:33.654965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c436780-9f17-468d-9084-8b927d9245c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe726b710>]}
[0m17:10:33.656179 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:33.776349 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:10:33.916287 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 5 files added, 1 files changed.
[0m17:10:33.917185 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_cleaned_real_estate_data.sql
[0m17:10:33.917870 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__real_estate_data_weekly.sql
[0m17:10:33.918532 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__real_estate_data.sql
[0m17:10:33.919045 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__stg_avg_price_per_city_residential.sql
[0m17:10:33.919641 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/staging/stg_staging__stats.sql
[0m17:10:33.920261 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/core/schema.yml
[0m17:10:33.920799 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__real_estate_data_weekly.sql
[0m17:10:33.921241 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__stg_avg_price_per_city_residential.sql
[0m17:10:33.921671 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/core/model_generator.sql
[0m17:10:33.922356 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__real_estate_data.sql
[0m17:10:33.922792 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_staging__stats.sql
[0m17:10:33.923685 [debug] [MainThread]: Partial parsing: deleted file: dbt_zoomcamp://models/staging/staging/stg_cleaned_real_estate_data.sql
[0m17:10:34.411514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c436780-9f17-468d-9084-8b927d9245c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3d67610>]}
[0m17:10:34.514169 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m17:10:34.517803 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m17:10:34.533374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c436780-9f17-468d-9084-8b927d9245c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3562090>]}
[0m17:10:34.534284 [info ] [MainThread]: Found 8 models, 4 sources, 569 macros
[0m17:10:34.535004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c436780-9f17-468d-9084-8b927d9245c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe2d36510>]}
[0m17:10:34.538188 [info ] [MainThread]: 
[0m17:10:34.538917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:34.539519 [info ] [MainThread]: 
[0m17:10:34.540536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:34.546536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db_public'
[0m17:10:34.602852 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m17:10:34.603765 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m17:10:34.604458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:34.623602 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m17:10:34.624272 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m17:10:34.624856 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:10:34.633016 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.008 seconds
[0m17:10:34.636331 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m17:10:34.637447 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m17:10:34.648210 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:34.648793 [debug] [MainThread]: On master: BEGIN
[0m17:10:34.649288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:34.662463 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:10:34.663192 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:34.663980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:34.671916 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m17:10:34.675694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c436780-9f17-468d-9084-8b927d9245c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe2db2c90>]}
[0m17:10:34.676360 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:34.677150 [debug] [MainThread]: On master: Close
[0m17:10:34.684097 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:10:34.684834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mage_db_public, now model.dbt_zoomcamp.stg_staging__real_estate_data)
[0m17:10:34.685398 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:10:34.695567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m17:10:34.696578 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:10:34.697970 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m17:10:34.699046 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:10:34.700473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data, now model.dbt_zoomcamp.stg_staging__real_estate_data_weekly)
[0m17:10:34.701329 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:10:34.707864 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m17:10:34.709022 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:10:34.710519 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m17:10:34.719194 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stats
[0m17:10:34.726804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data_weekly, now model.dbt_zoomcamp.stg_staging__stats)
[0m17:10:34.727832 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stats
[0m17:10:34.743102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stats"
[0m17:10:34.744395 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stats
[0m17:10:34.745950 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stats
[0m17:10:34.746873 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:10:34.750471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__stats, now model.dbt_zoomcamp.stg_cleaned_real_estate_data)
[0m17:10:34.751260 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:10:34.757815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m17:10:34.758999 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:10:34.760051 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m17:10:34.761602 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:10:34.762281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_cleaned_real_estate_data, now model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall)
[0m17:10:34.762836 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:10:34.767248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m17:10:34.768067 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:10:34.769050 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m17:10:34.769606 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:10:34.770354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall, now model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential)
[0m17:10:34.770891 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:10:34.775273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m17:10:34.776089 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:10:34.777136 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m17:10:34.777744 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.price_trends
[0m17:10:34.778480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential, now model.dbt_zoomcamp.price_trends)
[0m17:10:34.779032 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.price_trends
[0m17:10:34.783766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.price_trends"
[0m17:10:34.784618 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.price_trends
[0m17:10:34.785668 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.price_trends
[0m17:10:34.786385 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:10:34.787268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.price_trends, now model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential)
[0m17:10:34.787862 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:10:34.793754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m17:10:34.794612 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:10:34.795715 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m17:10:34.797439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:34.797872 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential' was properly closed.
[0m17:10:34.799934 [debug] [MainThread]: Command end result
[0m17:10:34.920191 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m17:10:34.922671 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m17:10:34.932447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m17:10:34.933948 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.6421347, "process_in_blocks": "0", "process_kernel_time": 0.396773, "process_mem_max_rss": "118508", "process_out_blocks": "3776", "process_user_time": 3.634788}
[0m17:10:34.934688 [debug] [MainThread]: Command `dbt compile` succeeded at 17:10:34.934500 after 1.64 seconds
[0m17:10:34.935266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe8a05d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe8a05e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe8a05d10>]}
[0m17:10:34.935868 [debug] [MainThread]: Flushing usage events
[0m17:10:35.265865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:54.935955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed499f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed499f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed499ef10>]}


============================== 17:13:54.940335 | 41014188-262e-46f6-a228-3cc246c7ae31 ==============================
[0m17:13:54.940335 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:13:54.941362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation codegen.create_base_models --args {source_name: core, tables: ["average_residential","average_city"]}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:13:55.162607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41014188-262e-46f6-a228-3cc246c7ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed4470a50>]}
[0m17:13:55.240548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41014188-262e-46f6-a228-3cc246c7ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed6767490>]}
[0m17:13:55.241844 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:13:55.358422 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:13:55.496012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:13:55.496663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:13:55.541657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41014188-262e-46f6-a228-3cc246c7ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed3354210>]}
[0m17:13:55.650911 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m17:13:55.654474 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m17:13:55.677997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41014188-262e-46f6-a228-3cc246c7ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed33735d0>]}
[0m17:13:55.678917 [info ] [MainThread]: Found 8 models, 4 sources, 569 macros
[0m17:13:55.679527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41014188-262e-46f6-a228-3cc246c7ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed3718610>]}
[0m17:13:55.680465 [debug] [MainThread]: Acquiring new postgres connection 'macro_create_base_models'
[0m17:13:55.680980 [debug] [MainThread]: Using postgres connection "macro_create_base_models"
[0m17:13:55.681457 [debug] [MainThread]: On macro_create_base_models: BEGIN
[0m17:13:55.681914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:55.695836 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:13:55.696516 [debug] [MainThread]: On macro_create_base_models: COMMIT
[0m17:13:55.697067 [debug] [MainThread]: Using postgres connection "macro_create_base_models"
[0m17:13:55.697526 [debug] [MainThread]: On macro_create_base_models: COMMIT
[0m17:13:55.698340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:13:55.709835 [info ] [MainThread]: Run these commands in your shell to generate the models:
source dbt_packages/codegen/bash_scripts/base_model_creation.sh core average_residential && 
source dbt_packages/codegen/bash_scripts/base_model_creation.sh core average_city
[0m17:13:55.710867 [debug] [MainThread]: On macro_create_base_models: Close
[0m17:13:55.722508 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m17:13:55.723959 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.85713434, "process_in_blocks": "16", "process_kernel_time": 0.302947, "process_mem_max_rss": "104080", "process_out_blocks": "1256", "process_user_time": 2.331196}
[0m17:13:55.724693 [debug] [MainThread]: Command `dbt run-operation` succeeded at 17:13:55.724486 after 0.86 seconds
[0m17:13:55.725256 [debug] [MainThread]: Connection 'macro_create_base_models' was properly closed.
[0m17:13:55.725781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed3348290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed3348050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed337f810>]}
[0m17:13:55.726420 [debug] [MainThread]: Flushing usage events
[0m17:13:56.097053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:30.362750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3daa517d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dae37390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dae37250>]}


============================== 17:14:30.369183 | 2bc95f84-9f89-45ec-ba42-f66de3209418 ==============================
[0m17:14:30.369183 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:14:30.370247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'version_check': 'True', 'profiles_dir': '/home/ruicarvalho/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'True', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --quiet run-operation codegen.generate_base_model --args {"source_name": "core", "table_name": "average_residential"}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:14:30.696051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bc95f84-9f89-45ec-ba42-f66de3209418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3da38afd0>]}
[0m17:14:30.814615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bc95f84-9f89-45ec-ba42-f66de3209418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dcc1ecd0>]}
[0m17:14:30.816424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:14:31.018895 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:14:31.242843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:14:31.244261 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/stg_core__average_residential.sql
[0m17:14:32.103330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bc95f84-9f89-45ec-ba42-f66de3209418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d9b45650>]}
[0m17:14:32.321137 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m17:14:32.324763 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m17:14:32.336856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bc95f84-9f89-45ec-ba42-f66de3209418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3da3ee850>]}
[0m17:14:32.337643 [info ] [MainThread]: Found 9 models, 4 sources, 569 macros
[0m17:14:32.338139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bc95f84-9f89-45ec-ba42-f66de3209418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d9b9dd90>]}
[0m17:14:32.339054 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_base_model'
[0m17:14:32.339556 [debug] [MainThread]: Using postgres connection "macro_generate_base_model"
[0m17:14:32.340011 [debug] [MainThread]: On macro_generate_base_model: BEGIN
[0m17:14:32.340438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:32.388185 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:14:32.388859 [debug] [MainThread]: On macro_generate_base_model: COMMIT
[0m17:14:32.389429 [debug] [MainThread]: Using postgres connection "macro_generate_base_model"
[0m17:14:32.389924 [debug] [MainThread]: On macro_generate_base_model: COMMIT
[0m17:14:32.390758 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:14:32.403687 [debug] [MainThread]: Postgres adapter: Error running SQL: macro generate_base_model
[0m17:14:32.404312 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:14:32.404880 [debug] [MainThread]: On macro_generate_base_model: Close
[0m17:14:32.405875 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  Macro 'macro.codegen.generate_base_model' (macros/generate_base_model.sql) depends on a source named 'core.average_residential' which was not found
  
  > in macro default__generate_base_model (macros/generate_base_model.sql)
  > called by macro generate_base_model (macros/generate_base_model.sql)
  > called by <Unknown>
[0m17:14:32.419845 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1193, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 355, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 29, in macro
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 49, in macro
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/context/providers.py", line 331, in __call__
    return self.resolve(args[0], args[1])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/context/providers.py", line 683, in resolve
    raise TargetNotFoundError(
dbt.exceptions.TargetNotFoundError: Compilation Error
  Macro 'macro.codegen.generate_base_model' (macros/generate_base_model.sql) depends on a source named 'core.average_residential' which was not found
  
  > in macro default__generate_base_model (macros/generate_base_model.sql)
  > called by macro generate_base_model (macros/generate_base_model.sql)
  > called by <Unknown>

[0m17:14:32.428702 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m17:14:32.430360 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 2.1750715, "process_in_blocks": "160", "process_kernel_time": 0.309439, "process_mem_max_rss": "109576", "process_out_blocks": "2496", "process_user_time": 3.419261}
[0m17:14:32.431066 [debug] [MainThread]: Command `dbt run-operation` failed at 17:14:32.430880 after 2.18 seconds
[0m17:14:32.431676 [debug] [MainThread]: Connection 'macro_generate_base_model' was properly closed.
[0m17:14:32.432204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d9b24390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d93cc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3de389dd0>]}
[0m17:14:32.432795 [debug] [MainThread]: Flushing usage events
[0m17:14:32.771477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:35.187614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c65364990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c65364b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c65364850>]}


============================== 17:14:35.193812 | ea842a37-ce18-46bb-a565-790ae17f3b91 ==============================
[0m17:14:35.193812 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:14:35.195081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --quiet run-operation codegen.generate_base_model --args {"source_name": "core", "table_name": "average_city"}', 'send_anonymous_usage_stats': 'True'}
[0m17:14:35.522237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea842a37-ce18-46bb-a565-790ae17f3b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c64fc7710>]}
[0m17:14:35.653117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea842a37-ce18-46bb-a565-790ae17f3b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6752e490>]}
[0m17:14:35.654987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:14:35.833224 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:14:36.054034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:14:36.055526 [debug] [MainThread]: Partial parsing: added file: dbt_zoomcamp://models/stg_core__average_city.sql
[0m17:14:36.056666 [debug] [MainThread]: Partial parsing: updated file: dbt_zoomcamp://models/stg_core__average_residential.sql
[0m17:14:36.594762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea842a37-ce18-46bb-a565-790ae17f3b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c63ff4090>]}
[0m17:14:36.773174 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m17:14:36.779076 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m17:14:36.797925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea842a37-ce18-46bb-a565-790ae17f3b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c63b08e90>]}
[0m17:14:36.799262 [info ] [MainThread]: Found 10 models, 4 sources, 569 macros
[0m17:14:36.800105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea842a37-ce18-46bb-a565-790ae17f3b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6474e150>]}
[0m17:14:36.801382 [debug] [MainThread]: Acquiring new postgres connection 'macro_generate_base_model'
[0m17:14:36.802264 [debug] [MainThread]: Using postgres connection "macro_generate_base_model"
[0m17:14:36.803061 [debug] [MainThread]: On macro_generate_base_model: BEGIN
[0m17:14:36.803832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:36.823351 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m17:14:36.824227 [debug] [MainThread]: On macro_generate_base_model: COMMIT
[0m17:14:36.824920 [debug] [MainThread]: Using postgres connection "macro_generate_base_model"
[0m17:14:36.825520 [debug] [MainThread]: On macro_generate_base_model: COMMIT
[0m17:14:36.826494 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:14:36.847333 [debug] [MainThread]: Postgres adapter: Error running SQL: macro generate_base_model
[0m17:14:36.848179 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:14:36.848862 [debug] [MainThread]: On macro_generate_base_model: Close
[0m17:14:36.853630 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  Macro 'macro.codegen.generate_base_model' (macros/generate_base_model.sql) depends on a source named 'core.average_city' which was not found
  
  > in macro default__generate_base_model (macros/generate_base_model.sql)
  > called by macro generate_base_model (macros/generate_base_model.sql)
  > called by <Unknown>
[0m17:14:36.858294 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1193, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 355, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 29, in macro
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 49, in macro
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/context/providers.py", line 331, in __call__
    return self.resolve(args[0], args[1])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruicarvalho/.venv/lib/python3.11/site-packages/dbt/context/providers.py", line 683, in resolve
    raise TargetNotFoundError(
dbt.exceptions.TargetNotFoundError: Compilation Error
  Macro 'macro.codegen.generate_base_model' (macros/generate_base_model.sql) depends on a source named 'core.average_city' which was not found
  
  > in macro default__generate_base_model (macros/generate_base_model.sql)
  > called by macro generate_base_model (macros/generate_base_model.sql)
  > called by <Unknown>

[0m17:14:36.871667 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m17:14:36.873363 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 1.7942063, "process_in_blocks": "0", "process_kernel_time": 0.307735, "process_mem_max_rss": "109672", "process_out_blocks": "2480", "process_user_time": 3.325338}
[0m17:14:36.874365 [debug] [MainThread]: Command `dbt run-operation` failed at 17:14:36.874071 after 1.80 seconds
[0m17:14:36.875084 [debug] [MainThread]: Connection 'macro_generate_base_model' was properly closed.
[0m17:14:36.875793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c6574b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c63b11090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c63787050>]}
[0m17:14:36.876573 [debug] [MainThread]: Flushing usage events
[0m17:14:37.217258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:27:28.510470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec5e58c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec5e58810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec5e58d90>]}


============================== 06:27:28.556992 | 5d45346e-917d-4df7-968d-51b3db393071 ==============================
[0m06:27:28.556992 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:27:28.558223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ruicarvalho/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m06:27:28.784480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec57ca590>]}
[0m06:27:28.866922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec802fc90>]}
[0m06:27:28.868156 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:27:29.076263 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:27:29.285320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:27:29.286242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:27:29.328181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec4b04050>]}
[0m06:27:29.436822 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m06:27:29.451580 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m06:27:29.591183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec3fdf850>]}
[0m06:27:29.592009 [info ] [MainThread]: Found 8 models, 4 sources, 569 macros
[0m06:27:29.595138 [info ] [MainThread]: 
[0m06:27:29.595730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:27:29.596266 [info ] [MainThread]: 
[0m06:27:29.597108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:27:29.605371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db'
[0m06:27:29.663175 [debug] [ThreadPool]: Using postgres connection "list_mage_db"
[0m06:27:29.663795 [debug] [ThreadPool]: On list_mage_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db"} */

    select distinct nspname from pg_namespace
  
[0m06:27:29.664275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:27:30.097324 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.433 seconds
[0m06:27:30.099413 [debug] [ThreadPool]: On list_mage_db: Close
[0m06:27:30.104977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mage_db_public'
[0m06:27:30.112810 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m06:27:30.113309 [debug] [ThreadPool]: On list_mage_db_public: BEGIN
[0m06:27:30.113755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:27:30.128424 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m06:27:30.129411 [debug] [ThreadPool]: Using postgres connection "list_mage_db_public"
[0m06:27:30.130315 [debug] [ThreadPool]: On list_mage_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "list_mage_db_public"} */
select
      'mage_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'mage_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:27:30.207030 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.076 seconds
[0m06:27:30.209205 [debug] [ThreadPool]: On list_mage_db_public: ROLLBACK
[0m06:27:30.210153 [debug] [ThreadPool]: On list_mage_db_public: Close
[0m06:27:30.220402 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:30.220921 [debug] [MainThread]: On master: BEGIN
[0m06:27:30.221417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:27:30.235277 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:27:30.235876 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:30.236493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:27:30.247216 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m06:27:30.250223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec2d76e50>]}
[0m06:27:30.250904 [debug] [MainThread]: On master: ROLLBACK
[0m06:27:30.251697 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:30.252130 [debug] [MainThread]: On master: BEGIN
[0m06:27:30.253417 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:27:30.254023 [debug] [MainThread]: On master: COMMIT
[0m06:27:30.255017 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:30.255718 [debug] [MainThread]: On master: COMMIT
[0m06:27:30.256830 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:30.257484 [debug] [MainThread]: On master: Close
[0m06:27:30.261624 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m06:27:30.262475 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_staging__real_estate_data ............... [RUN]
[0m06:27:30.263288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mage_db_public, now model.dbt_zoomcamp.stg_staging__real_estate_data)
[0m06:27:30.263847 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m06:27:30.274616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.275574 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m06:27:30.323393 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.325368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.326033 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: BEGIN
[0m06:27:30.326611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:30.340396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m06:27:30.341079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.341668 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */

  create view "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m06:27:30.384654 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m06:27:30.395805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.396498 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data" rename to "stg_staging__real_estate_data__dbt_backup"
[0m06:27:30.398484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:30.402924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.403470 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
alter table "mage_db"."public"."stg_staging__real_estate_data__dbt_tmp" rename to "stg_staging__real_estate_data"
[0m06:27:30.404860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:30.425527 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m06:27:30.426229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.426850 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: COMMIT
[0m06:27:30.429546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:27:30.437887 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data__dbt_backup"
[0m06:27:30.446059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data"
[0m06:27:30.446769 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data__dbt_backup" cascade
[0m06:27:30.463623 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m06:27:30.467045 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data: Close
[0m06:27:30.470924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec2d6b9d0>]}
[0m06:27:30.472361 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_staging__real_estate_data .......... [[32mCREATE VIEW[0m in 0.21s]
[0m06:27:30.473344 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data
[0m06:27:30.473941 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m06:27:30.474941 [info ] [Thread-1 (]: 2 of 8 START sql view model public.stg_staging__real_estate_data_weekly ........ [RUN]
[0m06:27:30.475817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data, now model.dbt_zoomcamp.stg_staging__real_estate_data_weekly)
[0m06:27:30.476349 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m06:27:30.481160 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.481973 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m06:27:30.489380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.490286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.490855 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: BEGIN
[0m06:27:30.491350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:30.503221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:27:30.504065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.504830 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */

  create view "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."real_estate_data_weekly"

),

renamed as (

    select
        unique_id,
        price,
        district,
        city,
        town,
        _type,
        energy_certificate,
        gross_area,
        total_area,
        parking,
        has_parking,
        _floor,
        construction_year,
        energy_efficiency_level,
        publish_date,
        garage,
        elevator,
        electric_cars_charging,
        total_rooms,
        number_of_bedrooms,
        number_of_w_c,
        conservation_status,
        living_area,
        lot_size,
        built_area,
        number_of_bathrooms,
        push_date

    from source

)

select * from renamed
  );
[0m06:27:30.510666 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:27:30.515295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.515856 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly" rename to "stg_staging__real_estate_data_weekly__dbt_backup"
[0m06:27:30.517209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:30.521301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.521846 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
alter table "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_tmp" rename to "stg_staging__real_estate_data_weekly"
[0m06:27:30.523086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:30.525010 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m06:27:30.525537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.526048 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: COMMIT
[0m06:27:30.528676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:27:30.532168 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup"
[0m06:27:30.533135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"
[0m06:27:30.533657 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly"} */
drop view if exists "mage_db"."public"."stg_staging__real_estate_data_weekly__dbt_backup" cascade
[0m06:27:30.537244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:27:30.539098 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__real_estate_data_weekly: Close
[0m06:27:30.540312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec2c26d90>]}
[0m06:27:30.541667 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.stg_staging__real_estate_data_weekly ... [[32mCREATE VIEW[0m in 0.06s]
[0m06:27:30.543380 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__real_estate_data_weekly
[0m06:27:30.543966 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stats
[0m06:27:30.544716 [info ] [Thread-1 (]: 3 of 8 START sql view model public.stg_staging__stats .......................... [RUN]
[0m06:27:30.545765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__real_estate_data_weekly, now model.dbt_zoomcamp.stg_staging__stats)
[0m06:27:30.546599 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stats
[0m06:27:30.552818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.553630 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stats
[0m06:27:30.558802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.559602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.560145 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: BEGIN
[0m06:27:30.560640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:30.571609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m06:27:30.572231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.572792 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */

  create view "mage_db"."public"."stg_staging__stats__dbt_tmp"
    
    
  as (
    with 

source as (

    select * from "mage_db"."public"."stats"

),

renamed as (

    select
        _column_name,
        data_type,
        missing_percent,
        missing_quant,
        dups,
        uniques,
        _count,
        _min,
        _max,
        average,
        standard_deviation

    from source

)

select * from renamed
  );
[0m06:27:30.576084 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m06:27:30.580971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.581545 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats" rename to "stg_staging__stats__dbt_backup"
[0m06:27:30.582843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:30.586867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.587384 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
alter table "mage_db"."public"."stg_staging__stats__dbt_tmp" rename to "stg_staging__stats"
[0m06:27:30.588566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:30.590663 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m06:27:30.591188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.591685 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: COMMIT
[0m06:27:30.593458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:27:30.596942 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stats__dbt_backup"
[0m06:27:30.598053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stats"
[0m06:27:30.598625 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stats"} */
drop view if exists "mage_db"."public"."stg_staging__stats__dbt_backup" cascade
[0m06:27:30.601691 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:27:30.603523 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stats: Close
[0m06:27:30.604669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec2c1cf10>]}
[0m06:27:30.605808 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.stg_staging__stats ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m06:27:30.608370 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stats
[0m06:27:30.609157 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m06:27:30.610239 [info ] [Thread-1 (]: 4 of 8 START sql view model public.stg_cleaned_real_estate_data ................ [RUN]
[0m06:27:30.611056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_staging__stats, now model.dbt_zoomcamp.stg_cleaned_real_estate_data)
[0m06:27:30.611649 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m06:27:30.619065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m06:27:30.619887 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m06:27:30.624577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m06:27:30.625414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m06:27:30.625967 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: BEGIN
[0m06:27:30.626540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:30.640515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m06:27:30.641174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m06:27:30.641730 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */

  create view "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp"
    
    
  as (
    WITH base AS (
    SELECT *
    FROM "mage_db"."public"."stg_staging__real_estate_data"
)
SELECT *
FROM base
WHERE total_area > 10
  AND price > 100
  AND price / NULLIF(total_area, 0) BETWEEN 100 AND 50000
  );
[0m06:27:30.647156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:27:30.651371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m06:27:30.651911 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
alter table "mage_db"."public"."stg_cleaned_real_estate_data__dbt_tmp" rename to "stg_cleaned_real_estate_data"
[0m06:27:30.653102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:30.654912 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m06:27:30.655440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m06:27:30.655949 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: COMMIT
[0m06:27:30.658394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:27:30.661804 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup"
[0m06:27:30.662788 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_cleaned_real_estate_data"
[0m06:27:30.663308 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data"} */
drop view if exists "mage_db"."public"."stg_cleaned_real_estate_data__dbt_backup" cascade
[0m06:27:30.664229 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:27:30.665927 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_cleaned_real_estate_data: Close
[0m06:27:30.667037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec2cdbcd0>]}
[0m06:27:30.668467 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.stg_cleaned_real_estate_data ........... [[32mCREATE VIEW[0m in 0.06s]
[0m06:27:30.670199 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_cleaned_real_estate_data
[0m06:27:30.671913 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m06:27:30.672684 [info ] [Thread-1 (]: 5 of 8 START sql table model public.avg_price_per_sqm_by_city_overall .......... [RUN]
[0m06:27:30.673435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.stg_cleaned_real_estate_data, now model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall)
[0m06:27:30.674122 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m06:27:30.678657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m06:27:30.679455 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m06:27:30.706936 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m06:27:30.708017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m06:27:30.708770 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: BEGIN
[0m06:27:30.709367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:30.721966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m06:27:30.722666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m06:27:30.723247 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"} */

  
    

  create  table "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_tmp"
  
  
    as
  
  (
    

with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
  )
select
  city,
  district,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city, district
order by avg_price_per_sqm desc
  );
  
[0m06:27:31.010300 [debug] [Thread-1 (]: SQL status: SELECT 271 in 0.286 seconds
[0m06:27:31.015092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m06:27:31.015726 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"} */
alter table "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_tmp" rename to "avg_price_per_sqm_by_city_overall"
[0m06:27:31.016911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:31.023041 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: COMMIT
[0m06:27:31.023648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m06:27:31.024167 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: COMMIT
[0m06:27:31.026594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:27:31.030081 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_backup"
[0m06:27:31.034699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"
[0m06:27:31.035317 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall"} */
drop table if exists "mage_db"."public"."avg_price_per_sqm_by_city_overall__dbt_backup" cascade
[0m06:27:31.036407 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:27:31.038314 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall: Close
[0m06:27:31.039511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec4f3d750>]}
[0m06:27:31.040729 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.avg_price_per_sqm_by_city_overall ..... [[32mSELECT 271[0m in 0.37s]
[0m06:27:31.041781 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall
[0m06:27:31.042541 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m06:27:31.043698 [info ] [Thread-1 (]: 6 of 8 START sql table model public.avg_price_per_sqm_by_city_residential ...... [RUN]
[0m06:27:31.044906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall, now model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential)
[0m06:27:31.045485 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m06:27:31.051675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m06:27:31.052710 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m06:27:31.060061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m06:27:31.061076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m06:27:31.061732 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: BEGIN
[0m06:27:31.062309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:31.073414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m06:27:31.074079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m06:27:31.074751 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"} */

  
    

  create  table "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_tmp"
  
  
    as
  
  (
    

WITH 
  base AS (
      SELECT
          city,
          district,
          total_area,
          price,
          price / NULLIF(total_area, 0) AS price_per_sqm
      FROM "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        AND total_area > 0  -- Ensure total_area is valid
        AND price > 0       -- Ensure price is valid
  )
SELECT
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  COUNT(*) AS property_count,
  ROUND(AVG(price_per_sqm)::numeric, 2) AS avg_price_per_sqm
FROM base
WHERE price_per_sqm <= 10000  -- Exclude rows where price_per_sqm is greater than 10,000
GROUP BY city
ORDER BY avg_price_per_sqm DESC
  );
  
[0m06:27:31.211210 [debug] [Thread-1 (]: SQL status: SELECT 269 in 0.136 seconds
[0m06:27:31.291990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m06:27:31.292729 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"} */
alter table "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_tmp" rename to "avg_price_per_sqm_by_city_residential"
[0m06:27:31.293994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:31.296232 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: COMMIT
[0m06:27:31.296806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m06:27:31.297327 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: COMMIT
[0m06:27:31.299829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:27:31.303360 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_backup"
[0m06:27:31.304374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"
[0m06:27:31.304914 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential"} */
drop table if exists "mage_db"."public"."avg_price_per_sqm_by_city_residential__dbt_backup" cascade
[0m06:27:31.305915 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:27:31.308147 [debug] [Thread-1 (]: On model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential: Close
[0m06:27:31.310522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec2c5a650>]}
[0m06:27:31.311814 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.avg_price_per_sqm_by_city_residential . [[32mSELECT 269[0m in 0.27s]
[0m06:27:31.313505 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential
[0m06:27:31.314135 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.price_trends
[0m06:27:31.314911 [info ] [Thread-1 (]: 7 of 8 START sql table model public.price_trends ............................... [RUN]
[0m06:27:31.315659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential, now model.dbt_zoomcamp.price_trends)
[0m06:27:31.316192 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.price_trends
[0m06:27:31.321166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.price_trends"
[0m06:27:31.321992 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.price_trends
[0m06:27:31.327173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.price_trends"
[0m06:27:31.328172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m06:27:31.328851 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: BEGIN
[0m06:27:31.329350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:31.340955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:27:31.341615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m06:27:31.342247 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.price_trends"} */

  
    

  create  table "mage_db"."public"."price_trends__dbt_tmp"
  
  
    as
  
  (
    

WITH date_trends AS (
    SELECT
        COALESCE(
            EXTRACT(YEAR FROM publish_date::DATE),
            EXTRACT(YEAR FROM push_date::DATE)
        ) AS year,
        CAST(
            COALESCE(
                EXTRACT(MONTH FROM publish_date::DATE),
                EXTRACT(MONTH FROM push_date::DATE)
            ) AS INT
        ) AS month, -- Ensure month is an integer
        ROUND(AVG(price)::numeric) AS avg_price, -- Remove decimal points
        COUNT(*) AS total_entries -- Count total listings
    FROM "mage_db"."public"."stg_cleaned_real_estate_data"
    WHERE price > 0
    GROUP BY year, month
)
SELECT
    year,
    month,
    TO_CHAR(avg_price, 'FM999,999,999') AS avg_price, -- No decimals, apply thousands separator
    TO_CHAR(total_entries, 'FM999,999,999') AS total_entries -- Apply thousands separator
FROM date_trends
ORDER BY year, month
  );
  
[0m06:27:31.528410 [debug] [Thread-1 (]: SQL status: SELECT 67 in 0.186 seconds
[0m06:27:31.533763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m06:27:31.534504 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.price_trends"} */
alter table "mage_db"."public"."price_trends" rename to "price_trends__dbt_backup"
[0m06:27:31.535965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:31.540335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m06:27:31.540915 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.price_trends"} */
alter table "mage_db"."public"."price_trends__dbt_tmp" rename to "price_trends"
[0m06:27:31.542147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:31.544400 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: COMMIT
[0m06:27:31.544957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m06:27:31.545462 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: COMMIT
[0m06:27:31.547668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:27:31.551882 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."price_trends__dbt_backup"
[0m06:27:31.553243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.price_trends"
[0m06:27:31.553767 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.price_trends"} */
drop table if exists "mage_db"."public"."price_trends__dbt_backup" cascade
[0m06:27:31.559897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:27:31.561919 [debug] [Thread-1 (]: On model.dbt_zoomcamp.price_trends: Close
[0m06:27:31.563174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec12ff8d0>]}
[0m06:27:31.564353 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.price_trends .......................... [[32mSELECT 67[0m in 0.25s]
[0m06:27:31.565882 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.price_trends
[0m06:27:31.566684 [debug] [Thread-1 (]: Began running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m06:27:31.567784 [info ] [Thread-1 (]: 8 of 8 START sql view model public.stg_staging__stg_avg_price_per_city_residential  [RUN]
[0m06:27:31.568655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_zoomcamp.price_trends, now model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential)
[0m06:27:31.569208 [debug] [Thread-1 (]: Began compiling node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m06:27:31.573982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.574896 [debug] [Thread-1 (]: Began executing node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m06:27:31.580057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.580975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.581577 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: BEGIN
[0m06:27:31.582129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:31.594351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:27:31.595134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.595795 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */

  create view "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp"
    
    
  as (
    with 
  base as (
      select
          city,
          district,
          total_area,
          price,
          price / nullif(total_area, 0) as price_per_sqm
      from "mage_db"."public"."stg_cleaned_real_estate_data"
      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')
        and total_area > 0  -- Ensure total_area is valid
        and price > 0       -- Ensure price is valid
  )
select
  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,
  city,
  count(*) as property_count,
  avg(price_per_sqm) as avg_price_per_sqm
from base
group by city
ORDER BY avg_price_per_sqm DESC
  );
[0m06:27:31.600230 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:27:31.610358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.611170 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
alter table "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_tmp" rename to "stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.612782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:27:31.616014 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m06:27:31.616618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.617139 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: COMMIT
[0m06:27:31.619179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:27:31.622676 [debug] [Thread-1 (]: Applying DROP to: "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup"
[0m06:27:31.623712 [debug] [Thread-1 (]: Using postgres connection "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"
[0m06:27:31.624269 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "dbt_zoomcamp", "target_name": "dev", "node_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential"} */
drop view if exists "mage_db"."public"."stg_staging__stg_avg_price_per_city_residential__dbt_backup" cascade
[0m06:27:31.625352 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:27:31.627186 [debug] [Thread-1 (]: On model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential: Close
[0m06:27:31.628206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d45346e-917d-4df7-968d-51b3db393071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec3b19f10>]}
[0m06:27:31.629490 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.stg_staging__stg_avg_price_per_city_residential  [[32mCREATE VIEW[0m in 0.06s]
[0m06:27:31.630666 [debug] [Thread-1 (]: Finished running node model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential
[0m06:27:31.632801 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:31.633235 [debug] [MainThread]: On master: BEGIN
[0m06:27:31.633677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:27:31.647440 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:27:31.648051 [debug] [MainThread]: On master: COMMIT
[0m06:27:31.648552 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:31.648996 [debug] [MainThread]: On master: COMMIT
[0m06:27:31.649740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:31.650225 [debug] [MainThread]: On master: Close
[0m06:27:31.651110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:27:31.651851 [debug] [MainThread]: Connection 'list_mage_db' was properly closed.
[0m06:27:31.652508 [debug] [MainThread]: Connection 'model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential' was properly closed.
[0m06:27:31.653427 [info ] [MainThread]: 
[0m06:27:31.654209 [info ] [MainThread]: Finished running 3 table models, 5 view models in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m06:27:31.656447 [debug] [MainThread]: Command end result
[0m06:27:31.700503 [debug] [MainThread]: Wrote artifact WritableManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/manifest.json
[0m06:27:31.702985 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/semantic_manifest.json
[0m06:27:31.713184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/target/run_results.json
[0m06:27:31.713736 [info ] [MainThread]: 
[0m06:27:31.714515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:27:31.715078 [info ] [MainThread]: 
[0m06:27:31.715672 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m06:27:31.716962 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.2795188, "process_in_blocks": "10208", "process_kernel_time": 0.523707, "process_mem_max_rss": "113792", "process_out_blocks": "2704", "process_user_time": 3.057376}
[0m06:27:31.717588 [debug] [MainThread]: Command `dbt build` succeeded at 06:27:31.717423 after 3.28 seconds
[0m06:27:31.718170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec98fe190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec978dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec978d3d0>]}
[0m06:27:31.718753 [debug] [MainThread]: Flushing usage events
[0m06:27:32.128659 [debug] [MainThread]: An error was encountered while trying to flush usage events
