{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-01-24T06:27:31.654822Z", "invocation_id": "5d45346e-917d-4df7-968d-51b3db393071", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:30.264196Z", "completed_at": "2025-01-24T06:27:30.275300Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:30.275952Z", "completed_at": "2025-01-24T06:27:30.466839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2050490379333496, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_zoomcamp.stg_staging__real_estate_data", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"mage_db\".\"public\".\"real_estate_data\"\n\n),\n\nrenamed as (\n\n    select\n        unique_id,\n        price,\n        district,\n        city,\n        town,\n        _type,\n        energy_certificate,\n        gross_area,\n        total_area,\n        parking,\n        has_parking,\n        _floor,\n        construction_year,\n        energy_efficiency_level,\n        publish_date,\n        garage,\n        elevator,\n        electric_cars_charging,\n        total_rooms,\n        number_of_bedrooms,\n        number_of_w_c,\n        conservation_status,\n        living_area,\n        lot_size,\n        built_area,\n        number_of_bathrooms,\n        push_date\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"mage_db\".\"public\".\"stg_staging__real_estate_data\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:30.476683Z", "completed_at": "2025-01-24T06:27:30.481748Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:30.482404Z", "completed_at": "2025-01-24T06:27:30.538958Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06445813179016113, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_zoomcamp.stg_staging__real_estate_data_weekly", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"mage_db\".\"public\".\"real_estate_data_weekly\"\n\n),\n\nrenamed as (\n\n    select\n        unique_id,\n        price,\n        district,\n        city,\n        town,\n        _type,\n        energy_certificate,\n        gross_area,\n        total_area,\n        parking,\n        has_parking,\n        _floor,\n        construction_year,\n        energy_efficiency_level,\n        publish_date,\n        garage,\n        elevator,\n        electric_cars_charging,\n        total_rooms,\n        number_of_bedrooms,\n        number_of_w_c,\n        conservation_status,\n        living_area,\n        lot_size,\n        built_area,\n        number_of_bathrooms,\n        push_date\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"mage_db\".\"public\".\"stg_staging__real_estate_data_weekly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:30.547059Z", "completed_at": "2025-01-24T06:27:30.553406Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:30.554120Z", "completed_at": "2025-01-24T06:27:30.603383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05890011787414551, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_zoomcamp.stg_staging__stats", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"mage_db\".\"public\".\"stats\"\n\n),\n\nrenamed as (\n\n    select\n        _column_name,\n        data_type,\n        missing_percent,\n        missing_quant,\n        dups,\n        uniques,\n        _count,\n        _min,\n        _max,\n        average,\n        standard_deviation\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "\"mage_db\".\"public\".\"stg_staging__stats\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:30.612106Z", "completed_at": "2025-01-24T06:27:30.619671Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:30.620305Z", "completed_at": "2025-01-24T06:27:30.665782Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05595803260803223, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_zoomcamp.stg_cleaned_real_estate_data", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT *\n    FROM \"mage_db\".\"public\".\"stg_staging__real_estate_data\"\n)\nSELECT *\nFROM base\nWHERE total_area > 10\n  AND price > 100\n  AND price / NULLIF(total_area, 0) BETWEEN 100 AND 50000", "relation_name": "\"mage_db\".\"public\".\"stg_cleaned_real_estate_data\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:30.674482Z", "completed_at": "2025-01-24T06:27:30.679240Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:30.679865Z", "completed_at": "2025-01-24T06:27:31.038147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3660440444946289, "adapter_response": {"_message": "SELECT 271", "code": "SELECT", "rows_affected": 271}, "message": "SELECT 271", "failures": null, "unique_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_overall", "compiled": true, "compiled_code": "\n\nwith \n  base as (\n      select\n          city,\n          district,\n          total_area,\n          price,\n          price / nullif(total_area, 0) as price_per_sqm\n      from \"mage_db\".\"public\".\"stg_cleaned_real_estate_data\"\n  )\nselect\n  city,\n  district,\n  count(*) as property_count,\n  avg(price_per_sqm) as avg_price_per_sqm\nfrom base\ngroup by city, district\norder by avg_price_per_sqm desc", "relation_name": "\"mage_db\".\"public\".\"avg_price_per_sqm_by_city_overall\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:31.045832Z", "completed_at": "2025-01-24T06:27:31.052462Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:31.053158Z", "completed_at": "2025-01-24T06:27:31.307941Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2656080722808838, "adapter_response": {"_message": "SELECT 269", "code": "SELECT", "rows_affected": 269}, "message": "SELECT 269", "failures": null, "unique_id": "model.dbt_zoomcamp.avg_price_per_sqm_by_city_residential", "compiled": true, "compiled_code": "\n\nWITH \n  base AS (\n      SELECT\n          city,\n          district,\n          total_area,\n          price,\n          price / NULLIF(total_area, 0) AS price_per_sqm\n      FROM \"mage_db\".\"public\".\"stg_cleaned_real_estate_data\"\n      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')\n        AND total_area > 0  -- Ensure total_area is valid\n        AND price > 0       -- Ensure price is valid\n  )\nSELECT\n  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,\n  city,\n  COUNT(*) AS property_count,\n  ROUND(AVG(price_per_sqm)::numeric, 2) AS avg_price_per_sqm\nFROM base\nWHERE price_per_sqm <= 10000  -- Exclude rows where price_per_sqm is greater than 10,000\nGROUP BY city\nORDER BY avg_price_per_sqm DESC", "relation_name": "\"mage_db\".\"public\".\"avg_price_per_sqm_by_city_residential\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:31.316519Z", "completed_at": "2025-01-24T06:27:31.321768Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:31.322401Z", "completed_at": "2025-01-24T06:27:31.561762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24745392799377441, "adapter_response": {"_message": "SELECT 67", "code": "SELECT", "rows_affected": 67}, "message": "SELECT 67", "failures": null, "unique_id": "model.dbt_zoomcamp.price_trends", "compiled": true, "compiled_code": "\n\nWITH date_trends AS (\n    SELECT\n        COALESCE(\n            EXTRACT(YEAR FROM publish_date::DATE),\n            EXTRACT(YEAR FROM push_date::DATE)\n        ) AS year,\n        CAST(\n            COALESCE(\n                EXTRACT(MONTH FROM publish_date::DATE),\n                EXTRACT(MONTH FROM push_date::DATE)\n            ) AS INT\n        ) AS month, -- Ensure month is an integer\n        ROUND(AVG(price)::numeric) AS avg_price, -- Remove decimal points\n        COUNT(*) AS total_entries -- Count total listings\n    FROM \"mage_db\".\"public\".\"stg_cleaned_real_estate_data\"\n    WHERE price > 0\n    GROUP BY year, month\n)\nSELECT\n    year,\n    month,\n    TO_CHAR(avg_price, 'FM999,999,999') AS avg_price, -- No decimals, apply thousands separator\n    TO_CHAR(total_entries, 'FM999,999,999') AS total_entries -- Apply thousands separator\nFROM date_trends\nORDER BY year, month", "relation_name": "\"mage_db\".\"public\".\"price_trends\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-24T06:27:31.569643Z", "completed_at": "2025-01-24T06:27:31.574654Z"}, {"name": "execute", "started_at": "2025-01-24T06:27:31.575320Z", "completed_at": "2025-01-24T06:27:31.627047Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.059470176696777344, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_zoomcamp.stg_staging__stg_avg_price_per_city_residential", "compiled": true, "compiled_code": "with \n  base as (\n      select\n          city,\n          district,\n          total_area,\n          price,\n          price / nullif(total_area, 0) as price_per_sqm\n      from \"mage_db\".\"public\".\"stg_cleaned_real_estate_data\"\n      WHERE _type IN ('Apartment', 'House', 'Duplex', 'Studio', 'Other-Residential', 'Mansion')\n        and total_area > 0  -- Ensure total_area is valid\n        and price > 0       -- Ensure price is valid\n  )\nselect\n  ROW_NUMBER() OVER (ORDER BY ROUND(AVG(price_per_sqm)::numeric, 2) DESC) AS index,\n  city,\n  count(*) as property_count,\n  avg(price_per_sqm) as avg_price_per_sqm\nfrom base\ngroup by city\nORDER BY avg_price_per_sqm DESC", "relation_name": "\"mage_db\".\"public\".\"stg_staging__stg_avg_price_per_city_residential\"", "batch_results": null}], "elapsed_time": 2.056401014328003, "args": {"state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "partial_parse": true, "project_dir": "/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp", "send_anonymous_usage_stats": true, "static_parser": true, "introspect": true, "log_level": "info", "exclude": [], "macro_debugging": false, "empty": false, "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "printer_width": 80, "exclude_resource_types": [], "log_path": "/home/ruicarvalho/de_zoomcamp_final_project/dbt_zoomcamp/logs", "show_resource_report": false, "use_colors_file": true, "version_check": true, "write_json": true, "partial_parse_file_diff": true, "state_modified_compare_vars": false, "require_nested_cumulative_type_params": false, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "/home/ruicarvalho/.dbt", "strict_mode": false, "quiet": false, "resource_types": [], "vars": {}, "export_saved_queries": false, "invocation_command": "dbt build", "include_saved_query": false, "source_freshness_run_project_hooks": false, "cache_selected_only": false, "log_file_max_bytes": 10485760, "print": true, "require_resource_names_without_spaces": false, "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "require_batched_execution_for_custom_microbatch_strategy": false, "which": "build", "select": [], "favor_state": false, "indirect_selection": "eager", "show": false, "populate_cache": true, "defer": false}}